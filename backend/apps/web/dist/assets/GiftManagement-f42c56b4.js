import{r,g as G,j as e,A as T}from"./index-5be64975.js";import{S as A}from"./StandardTable-046e436b.js";import{I as N}from"./IconActionButton-2bcd0b2a.js";import{P as V}from"./PencilIcon-0921d86f.js";import{T as E}from"./TrashIcon-c73d815d.js";import{M}from"./MagnifyingGlassIcon-34e54beb.js";import{P as O}from"./PlusIcon-86b6a2f5.js";import{G as L}from"./GiftIcon-bda10844.js";import{C as F}from"./ClockIcon-8dc756af.js";import{X as P}from"./XCircleIcon-81e55d0c.js";import{C as $}from"./CheckCircleIcon-3b5f52cb.js";import"./chevron-down-e41c1b61.js";function f(){return Array.from({length:10}).map((c,l)=>({id:`GF-${l+1}`,name:`贈品${l+1}`,stock:Math.max(0,100-l*7),status:["active","out_of_stock","inactive"][l%3]}))}const g={async getGifts(){return{success:!0,data:f()}},async getGiftStatistics(){const c=f(),l=c.length,m=c.filter(n=>n.status==="active").length,d=c.filter(n=>n.status==="out_of_stock"||n.stock===0).length,o=c.reduce((n,i)=>n+i.stock,0);return{success:!0,data:{totalGifts:l,activeGifts:m,outOfStock:d,totalValue:o}}},async deleteGift(c){return{success:!0}},getAllGifts(){return f()}},v={ACTIVE:"active",OUT_OF_STOCK:"out_of_stock",INACTIVE:"inactive"},Z=()=>{const[c,l]=r.useState([]),[m,d]=r.useState(!0),[o,n]=r.useState(""),[i,w]=r.useState("all"),[k,p]=r.useState(!1),[t,x]=r.useState(null),[D,S]=r.useState({totalGifts:0,activeGifts:0,outOfStock:0,totalValue:0});r.useEffect(()=>{h(),b(),G.fromTo(".gift-card",{opacity:0,y:20},{opacity:1,y:0,duration:.6,stagger:.1,ease:"power2.out"})},[]);const h=async()=>{d(!0);try{const s=await g.getGifts();s.success&&l(s.data)}catch(s){console.error("Error loading gifts:",s)}finally{d(!1)}},b=async()=>{try{const s=await g.getGiftStatistics();s.success&&S(s.data)}catch(s){console.error("Error loading statistics:",s)}},y=r.useCallback(async s=>{if(window.confirm("確定要刪除這個禮品嗎？此操作無法復原。")){const a=await g.deleteGift(s);a!=null&&a.success?(await h(),await b()):alert("刪除失敗："+((a==null?void 0:a.error)||"未知錯誤"))}},[]),C=s=>{const u={active:{label:"啟用中",className:"bg-green-100 text-green-800"},out_of_stock:{label:"缺貨",className:"bg-red-100 text-red-800"},inactive:{label:"停用",className:"bg-gray-100 text-gray-800"}}[s]||{label:s,className:"bg-gray-100 text-gray-800"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${u.className}`,children:u.label})},I=s=>{switch(s){case v.ACTIVE:return e.jsx($,{className:"w-5 h-5 text-green-600"});case v.OUT_OF_STOCK:return e.jsx(P,{className:"w-5 h-5 text-red-600"});default:return e.jsx(F,{className:"w-5 h-5 text-gray-600"})}},j=c.filter(s=>{const a=s.name.toLowerCase().includes(o.toLowerCase())||s.description.toLowerCase().includes(o.toLowerCase()),u=i==="all"||s.status===i;return a&&u}),_=r.useMemo(()=>[{key:"name",label:"禮品",render:(s,a)=>e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.name}),e.jsx("div",{className:"text-xs text-gray-500 line-clamp-1",children:a.description})]})},{key:"status",label:"狀態",render:s=>e.jsxs("div",{className:"flex items-center gap-1",children:[I(s),C(s)]})},{key:"pointsRequired",label:"所需積分"},{key:"stock",label:"庫存數量"},{key:"redeemedCount",label:"已兌換"},{key:"value",label:"價值",render:s=>e.jsx("span",{className:"text-[#cc824d]",children:s})},{key:"actions",label:"操作",render:(s,a)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{Icon:V,label:"編輯",variant:"amber",onClick:()=>x(a)}),e.jsx(N,{Icon:E,label:"刪除",variant:"red",onClick:()=>y(a.id)})]})}],[x,y]);return m?e.jsx("div",{className:"bg-[#fdf8f2] min-h-screen p-6",children:e.jsxs("div",{className:"flex justify-center items-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#cc824d]"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"載入禮品數據中..."})]})}):e.jsxs("div",{className:"bg-[#fdf8f2] min-h-screen p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 font-chinese",children:"禮品管理"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"管理會員禮品與兌換系統"})]}),e.jsx("div",{className:`${T.glassCard} p-6 mb-6`,children:e.jsxs("div",{className:"flex gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-xl",children:[e.jsx(M,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"搜尋禮品名稱或描述...",value:o,onChange:s=>n(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#cc824d] focus:border-transparent"})]}),e.jsxs("select",{value:i,onChange:s=>w(s.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#cc824d] focus:border-transparent",children:[e.jsx("option",{value:"all",children:"所有狀態"}),e.jsx("option",{value:"active",children:"啟用中"}),e.jsx("option",{value:"out_of_stock",children:"缺貨"}),e.jsx("option",{value:"inactive",children:"停用"})]})]}),e.jsxs("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-[#cc824d] text-white rounded-lg hover:bg-[#b8743d] transition-colors flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"新增禮品"]})]})}),e.jsx(A,{data:j,columns:_,title:"禮品清單",exportFileName:"禮品清單"}),j.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(L,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-500 text-lg",children:"沒有找到符合條件的禮品"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"嘗試調整搜尋條件或新增新的禮品"})]}),(k||t)&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4 font-chinese",children:t?"編輯禮品":"新增禮品"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"禮品名稱"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#cc824d] focus:border-transparent",placeholder:"輸入禮品名稱",defaultValue:(t==null?void 0:t.name)||""})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"描述"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#cc824d] focus:border-transparent",rows:"3",placeholder:"輸入禮品描述",defaultValue:(t==null?void 0:t.description)||""})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"所需積分"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#cc824d] focus:border-transparent",placeholder:"0",defaultValue:(t==null?void 0:t.pointsRequired)||""})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"庫存數量"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#cc824d] focus:border-transparent",placeholder:"0",defaultValue:(t==null?void 0:t.stock)||""})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"禮品價值"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#cc824d] focus:border-transparent",placeholder:"0",defaultValue:(t==null?void 0:t.value)||""})]})]}),e.jsxs("div",{className:"flex space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>{p(!1),x(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"取消"}),e.jsx("button",{className:"flex-1 px-4 py-2 bg-[#cc824d] text-white rounded-lg hover:bg-[#b8743d] transition-colors",children:t?"更新":"新增"})]})]})})]})};export{Z as default};
