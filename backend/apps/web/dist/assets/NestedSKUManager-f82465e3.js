import{r as h,j as e,A as B}from"./index-09c3368c.js";import{Q as he}from"./QRCodeGenerator-edf9c63c.js";import{X as te}from"./XMarkIcon-93d59038.js";import{P as oe}from"./PlusIcon-3d2e3b30.js";import{C as fe}from"./CubeIcon-1f7f940f.js";import{C as le}from"./CheckCircleIcon-377c1a08.js";import{P as ce}from"./PencilIcon-619ae986.js";import{C as ge}from"./ChevronDownIcon-05511def.js";import{C as pe}from"./ChevronRightIcon-4b094a17.js";import{C as je}from"./Cog6ToothIcon-f8515c56.js";import{T as Ne}from"./TrashIcon-41cd83e4.js";import{E as ve}from"./ExclamationTriangleIcon-8f54841e.js";import{Q as ye}from"./QrCodeIcon-0fb2cc7f.js";function be({title:t,titleId:d,...i},j){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:j,"aria-labelledby":d},i),t?h.createElement("title",{id:d},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const we=h.forwardRef(be),Ce=we;function ke({title:t,titleId:d,...i},j){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:j,"aria-labelledby":d},i),t?h.createElement("title",{id:d},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))}const Se=h.forwardRef(ke),Te=Se;function Pe({title:t,titleId:d,...i},j){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:j,"aria-labelledby":d},i),t?h.createElement("title",{id:d},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const Ee=h.forwardRef(Pe),$e=Ee,Ae=({images:t=[],onChange:d,maxImages:i=10})=>{const[j,w]=h.useState(!1),S=h.useRef(null),K=l=>{const E=Array.from(l).filter(v=>v.type.startsWith("image/")?v.size>10*1024*1024?(alert(`${v.name} 文件過大，請選擇小於 10MB 的圖片`),!1):!0:(alert(`${v.name} 不是有效的圖片文件`),!1)),b=Math.max(0,i-t.length);if(b===0){alert(`最多只能上傳 ${i} 張圖片`);return}const c=E.slice(0,b);E.length>b&&alert(`已達上限，只加入前 ${b} 張圖片`);const C=c.map(v=>new Promise(U=>{const D=new FileReader;D.onload=L=>{U({id:Date.now()+Math.random(),file:v,url:L.target.result,name:v.name,size:v.size,type:v.type})},D.readAsDataURL(v)}));Promise.all(C).then(v=>{d([...t,...v])})},A=l=>{l.preventDefault(),l.stopPropagation(),l.type==="dragenter"||l.type==="dragover"?w(!0):l.type==="dragleave"&&w(!1)},I=l=>{l.preventDefault(),l.stopPropagation(),w(!1),l.dataTransfer.files&&l.dataTransfer.files[0]&&K(l.dataTransfer.files)},T=l=>{l.target.files&&l.target.files[0]&&K(l.target.files)},y=l=>{d(t.filter(P=>P.id!==l))};return e.jsxs("div",{className:"space-y-4",children:[t.length>0&&e.jsx("div",{className:"grid grid-cols-5 gap-4",children:t.map((l,P)=>e.jsxs("div",{className:"relative group bg-gray-100 rounded-lg overflow-hidden aspect-square",children:[e.jsx("img",{src:l.url,alt:l.name,className:"w-full h-full object-cover"}),P===0&&e.jsx("div",{className:"absolute top-2 left-2 bg-green-500 text-white text-xs px-2 py-1 rounded",children:"主圖"}),e.jsx("button",{type:"button",onClick:()=>y(l.id),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(te,{className:"w-4 h-4"})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("div",{className:"truncate",children:l.name}),e.jsxs("div",{children:[(l.size/1024/1024).toFixed(2)," MB"]})]})]},l.id))}),t.length<i&&e.jsxs("div",{className:`
            border-2 border-dashed rounded-lg p-8 text-center transition-colors
            ${j?"border-[#cc824d] bg-[#cc824d]/5":"border-gray-300 hover:border-gray-400"}
          `,onDragEnter:A,onDragLeave:A,onDragOver:A,onDrop:I,children:[e.jsx($e,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"拖拽圖片到此處或點擊上傳"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"支援 PNG, JPG, GIF 格式，最大 10MB"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["還可以上傳 ",i-t.length," 張圖片"]}),e.jsxs("button",{type:"button",onClick:()=>{var l;return(l=S.current)==null?void 0:l.click()},className:"mt-4 inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(Te,{className:"w-4 h-4 mr-2"}),"選擇圖片"]}),e.jsx("input",{ref:S,type:"file",multiple:!0,accept:"image/*",onChange:T,className:"hidden"})]}),e.jsx("div",{className:"text-sm text-gray-500",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• 第一張圖片將作為主圖顯示"}),e.jsx("li",{children:"• 可以拖拽圖片調整順序"}),e.jsx("li",{children:"• 建議圖片比例為 1:1 (正方形)"}),e.jsx("li",{children:"• 最佳解析度：800x800 像素以上"})]})})]})},ie=()=>Date.now()+Math.random(),W=()=>({price:"",comparePrice:"",costPrice:"",quantity:"",lowStockThreshold:5,allowBackorder:!1,trackQuantity:!0,weight:"",dimensions:{length:"",width:"",height:""},isActive:!0,barcode:"",hsCode:"",origin:"",note:"",variantImages:[]}),Ve=({baseSKU:t,skuVariants:d,onChange:i,basePrice:j=0,baseComparePrice:w=0,baseCostPrice:S=0,productName:K="",productCategories:A=[],singleVariant:I=!1,variantSelected:T=null})=>{const[y,l]=h.useState([]),[P,E]=h.useState(new Set),[b,c]=h.useState(null),[C,v]=h.useState(!1),[U,D]=h.useState({}),[L,O]=h.useState(!1);h.useEffect(()=>{d&&d.length>0&&y.length===0&&!L?(z(d),O(!0)):!L&&(!d||d.length===0)&&O(!0)},[d,t,y.length,L,z]);const z=h.useCallback(s=>{if(!s||s.length===0)return;const r=[],n={};s.forEach(a=>{if(a.path&&a.path.length>0){let o=r;a.path.forEach((u,p)=>{const g=p+1;n[g]=u.level;let m=o.find(f=>f.name===u.option&&f.level===g);m||(m={id:ie(),name:u.option,skuCode:"",fullSKU:t||"",level:g,children:[],config:W()},o.push(m)),p===a.path.length-1&&(a.config&&(m.config={...W(),...a.config}),a.sku&&(m.fullSKU=a.sku)),o=m.children})}}),l(r),D(n)},[t]);h.useEffect(()=>{if(!I||!T)return;const s=T||{},r={id:s.id||`var-${Date.now()}`,fullSKU:s.sku||t||"",sku:s.sku||t||"",name:s.name||"",config:{...W(),...s.config||{}},pathInfo:Array.isArray(s.path)?s.path.map(n=>({level:n.level,option:n.option})):[]};c(r),v(!0)},[I,T,t]);const V=(s,r)=>{D(n=>({...n,[s]:r}))},M=s=>U[s]||`第 ${s} 層`,G=(s,r="")=>({id:ie(),name:"",skuCode:"",fullSKU:r,level:s,children:[],config:W(),isEditing:!0}),se=()=>{const s=G(1,t||"");l(r=>{const n=[...r,s];return setTimeout(()=>{const a=Q(n);i&&i(a)},50),n})},q=(s,r,n,a=s)=>s.map(o=>{if(o.id===r){const u={...o,...n};if("skuCode"in n||"name"in n){const g=Z(a,r).slice(0,-1),m=H(g);u.fullSKU=m+(n.skuCode||u.skuCode||""),u.children=X(u.children,u.fullSKU)}return u}return{...o,children:q(o.children,r,n,a)}}),Z=(s,r)=>{const n=(a,o,u=[])=>{for(const p of a){const g=[...u,p];if(p.id===o)return g;if(p.children){const m=n(p.children,o,g);if(m)return m}}return null};return n(s,r)||[]},H=(s,r=null)=>{let n=t||"";for(let a=0;a<s.length;a++){const o=s[a],u=a===s.length-1&&r!==null?r:o.skuCode||"";n+=u}return n},X=(s,r)=>!Array.isArray(s)||s.length===0?[]:s.map(n=>{const a=r+(n.skuCode||"");return{...n,fullSKU:a,children:X(n.children,a)}}),_=(s,r,n)=>{l(a=>{let o;if(r.includes(".")){const[u,p]=r.split(".");if(u==="config"){const g=f=>{for(const N of f){if(N.id===s)return N;const x=g(N.children);if(x)return x}return null},m=g(a);o=q(a,s,{config:{...m==null?void 0:m.config,[p]:n}})}else o=a}else o=q(a,s,{[r]:n});return setTimeout(()=>{const u=Q(o);if(i&&i(u),b&&b.id===s){const p=m=>{for(const f of m){if(f.id===s)return f;const N=p(f.children||[]);if(N)return N}return null},g=p(o);if(g){const m=(N,x,R=[])=>{for(const F of N){const $=M(F.level),Y=[...R,{level:$,option:F.name||"未命名"}];if(F.id===x)return Y;const ee=m(F.children||[],x,Y);if(ee)return ee}return null},f=m(o,s)||[];c({...g,pathInfo:f})}}},50),o})},J=s=>{l(r=>{const n=g=>{for(const m of g){if(m.id===s)return m;const f=n(m.children);if(f)return f}return null},a=n(r);if(!a)return r;const o=Z(r,s),u=H(o),p=q(r,s,{children:[...a.children||[],G(a.level+1,u)]});return setTimeout(()=>{const g=Q(p);i&&i(g)},100),p})},re=s=>{l(r=>{const n=f=>{for(const N of f){if(N.id===s)return N;const x=n(N.children);if(x)return x}return null},a=n(r);if(!a)return r;const o=(f,N)=>{for(const x of f){if(x.children.some(F=>F.id===N))return x.fullSKU;const R=o(x.children,N);if(R!=null)return R}return null},u=o(r,s)??(t||""),p=G(a.level,u),g=f=>{const N=f.findIndex(x=>x.id===s);if(N!==-1){const x=[...f];return x.splice(N+1,0,p),x}return f.map(x=>({...x,children:g(x.children)}))},m=g(r);return setTimeout(()=>{const f=Q(m);i&&i(f)},100),m})},k=s=>{l(r=>{const n=o=>o.filter(u=>u.id!==s).map(u=>({...u,children:n(u.children)})),a=n(r);return setTimeout(()=>{const o=Q(a);i&&i(o)},100),a})},ne=s=>{E(r=>{const n=new Set(r);return n.has(s)?n.delete(s):n.add(s),n})},me=s=>{const r=xe(s.id);c({...s,pathInfo:r}),v(!0)},xe=s=>{const r=[],n=(a,o,u=[])=>{for(const p of a){const g=M(p.level),m=[...u,{level:g,option:p.name||"未命名"}];if(p.id===o)return r.push(...m),!0;if(n(p.children,o,m))return!0}return!1};return n(y,s),r},Q=h.useCallback((s=null)=>{const r=s||y,n=[],a=m=>{const f=parseFloat(m);return Number.isFinite(f)?f:0},o=a(j),u=a(w),p=a(S),g=(m,f=t||"",N=[])=>{m.forEach(x=>{const R=f+(x.skuCode||""),F=[...N,{level:U[x.level]||`層級${x.level}`,option:x.name||"未命名選項"}];if(!x.children||x.children.length===0){if(x.skuCode&&x.skuCode.trim()){const $=x.config||W(),Y=a($.price),ee=a($.comparePrice),ue=a($.costPrice);n.push({id:`sku-${x.id}`,sku:R,name:x.name||"未命名選項",path:F,pathDisplay:F.map(ae=>`${ae.level}: ${ae.option}`).join(" → "),config:$,price:$.price,comparePrice:$.comparePrice,costPrice:$.costPrice,quantity:$.quantity,trackQuantity:$.trackQuantity,isActive:$.isActive,finalPrice:o+Y,finalComparePrice:u+ee,finalCostPrice:p+ue})}}else g(x.children,R,F)})};return g(r),n},[y,t,U,j,w,S]);return h.useEffect(()=>{if(y.length>0&&L){const s=Q();i&&s.length>0&&i(s)}},[y,t,L,j,w,S,Q,i]),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"flex gap-6",children:[!I&&e.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg transition-all duration-300 ${C?"w-2/3":"w-full"}`,children:[e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"SKU 結構樹"}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("button",{onClick:se,className:`${B.btnPrimary} text-sm inline-flex items-center whitespace-nowrap`,children:[e.jsx(oe,{className:"w-4 h-4 mr-1"}),"添加根層級"]})})]})}),e.jsx("div",{className:"p-4 max-h-96 overflow-y-auto",children:y.length>0?e.jsx("div",{className:"space-y-2",children:y.map((s,r)=>e.jsx(de,{node:s,expandedItems:P,onToggleExpand:ne,onUpdateNode:_,onDeleteNode:k,onAddChild:J,onAddSibling:re,onSelectForConfig:me,isFirstInLevel:r===0,levelTitle:M(s.level),onUpdateLevelTitle:V,getLevelTitle:M},s.id))}):e.jsxs("div",{className:"text-center py-12 text-gray-500 border-2 border-dashed border-gray-300 rounded-lg",children:[e.jsx(fe,{className:"mx-auto h-16 w-16 text-gray-300 mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"還沒有建立 SKU 結構"}),e.jsx("p",{className:"text-sm",children:"點擊「添加根層級」開始建立 SKU 樹狀結構"})]})})]}),C&&b&&e.jsxs("div",{className:`${I?"w-full":"w-1/3"} bg-white border border-gray-200 rounded-lg`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"SKU 詳細設定"}),e.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(te,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:b.fullSKU})]}),e.jsx("div",{className:"p-4 max-h-96 overflow-y-auto",children:e.jsx(Ie,{sku:b,onUpdate:(s,r)=>_(b.id,s,r),baseSKU:t,getLevelTitle:M,basePrice:j,baseComparePrice:w,baseCostPrice:S,productName:K,productCategories:A})})]})]})})},de=({node:t,expandedItems:d,onToggleExpand:i,onUpdateNode:j,onDeleteNode:w,onAddChild:S,onAddSibling:K,onSelectForConfig:A,isFirstInLevel:I=!1,levelTitle:T="",onUpdateLevelTitle:y,getLevelTitle:l})=>{const[P,E]=h.useState(t.isEditing||!1),[b,c]=h.useState(!1),[C,v]=h.useState(""),[U,D]=h.useState(""),[L,O]=h.useState(""),z=t.children&&t.children.length>0,V=d.has(t.id),M=t.level<5,G=!z,se=()=>{v(t.name||""),D(t.skuCode||""),E(!0)},q=()=>{C!==t.name&&j(t.id,"name",C),U!==t.skuCode&&j(t.id,"skuCode",U),j(t.id,"isEditing",!1),E(!1)},Z=()=>{E(!1)},H=()=>{O(T),c(!0)},X=()=>{y(t.level,L),c(!1)},_=()=>{c(!1)},J=()=>({1:"pl-0",2:"pl-6",3:"pl-12",4:"pl-18",5:"pl-24"})[t.level]||"pl-0",re=()=>({1:"bg-blue-100 text-blue-800",2:"bg-green-100 text-green-800",3:"bg-purple-100 text-purple-800",4:"bg-orange-100 text-orange-800",5:"bg-red-100 text-red-800"})[t.level]||"bg-gray-100 text-gray-800";return e.jsxs("div",{className:"select-none",children:[I&&e.jsx("div",{className:`mb-2 ${J()}`,children:b?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:L,onChange:k=>O(k.target.value),className:"px-2 py-1 border border-gray-300 rounded text-sm font-medium",placeholder:`第 ${t.level} 層標題`,autoFocus:!0}),e.jsx("button",{onClick:X,className:"text-green-600 hover:text-green-700 p-1",children:e.jsx(le,{className:"w-4 h-4"})}),e.jsx("button",{onClick:_,className:"text-red-600 hover:text-red-700 p-1",children:e.jsx(te,{className:"w-4 h-4"})})]}):e.jsxs("div",{className:"flex items-center justify-between py-1 px-2 bg-gray-100 rounded cursor-pointer hover:bg-gray-200",onClick:H,children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700",children:T||`第 ${t.level} 層`}),e.jsx(ce,{className:"w-3 h-3 text-gray-400"})]})}),e.jsxs("div",{className:`flex items-center py-2 hover:bg-gray-50 rounded-lg transition-colors ${J()}`,children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 mr-2",children:z?e.jsx("button",{onClick:()=>i(t.id),className:"p-1 hover:bg-gray-200 rounded",children:V?e.jsx(ge,{className:"w-4 h-4 text-gray-500"}):e.jsx(pe,{className:"w-4 h-4 text-gray-500"})}):e.jsx("div",{className:"w-4 h-4"})}),e.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium mr-3 ${re()}`,children:["L",t.level]}),e.jsx("div",{className:"flex-1 flex items-center space-x-3",children:P?e.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[e.jsx("input",{type:"text",value:C,onChange:k=>v(k.target.value),className:"px-2 py-1 border border-gray-300 rounded text-sm flex-1",placeholder:"選項名稱 (例如：黑色、大號)",autoFocus:!0}),e.jsx("input",{type:"text",value:U,onChange:k=>D(k.target.value.toLowerCase().replace(/[^a-z0-9]/g,"")),className:"px-2 py-1 border border-gray-300 rounded text-sm w-20",placeholder:"sku",maxLength:3}),e.jsx("button",{onClick:q,className:"text-green-600 hover:text-green-700 p-1",children:e.jsx(le,{className:"w-4 h-4"})}),e.jsx("button",{onClick:Z,className:"text-red-600 hover:text-red-700 p-1",children:e.jsx(te,{className:"w-4 h-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[t.name||"未命名選項",t.skuCode&&e.jsxs("span",{className:"ml-2 text-sm font-mono text-gray-600",children:["[",t.skuCode,"]"]})]}),t.fullSKU&&e.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:["完整 SKU: ",t.fullSKU]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:se,className:"text-gray-400 hover:text-blue-600 p-1 rounded",title:"編輯選項",children:e.jsx(ce,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>K(t.id),className:"text-gray-400 hover:text-orange-600 p-1 rounded",title:"添加同層級選項",children:e.jsx(oe,{className:"w-4 h-4"})}),M&&e.jsx("button",{onClick:()=>S(t.id),className:"text-gray-400 hover:text-green-600 p-1 rounded",title:"添加下一層級",children:e.jsx(Ce,{className:"w-4 h-4"})}),G&&e.jsx("button",{onClick:()=>A(t),className:"text-gray-400 hover:text-[#cc824d] p-1 rounded",title:"設定 SKU 詳細資訊",children:e.jsx(je,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>w(t.id),className:"text-gray-400 hover:text-red-600 p-1 rounded",title:"刪除",children:e.jsx(Ne,{className:"w-4 h-4"})})]})]})})]}),z&&V&&e.jsx("div",{className:"ml-2",children:t.children.map((k,ne)=>e.jsx(de,{node:k,expandedItems:d,onToggleExpand:i,onUpdateNode:j,onDeleteNode:w,onAddChild:S,onAddSibling:K,onSelectForConfig:A,isFirstInLevel:ne===0,levelTitle:l?l(k.level):`第 ${k.level} 層`,onUpdateLevelTitle:y,getLevelTitle:l},k.id))})]})},Ie=({sku:t,onUpdate:d,baseSKU:i,getLevelTitle:j,basePrice:w=0,baseComparePrice:S=0,baseCostPrice:K=0,productName:A="",productCategories:I=[]})=>{const T=t.config.trackQuantity?(parseInt(t.config.quantity)||0)<=(parseInt(t.config.lowStockThreshold)||0)?"low":"normal":"unlimited",y=t.pathInfo||[],l=c=>{const C=parseFloat(c);return Number.isFinite(C)?C:0},P=l(w)+l(t.config.price),E=l(S)+l(t.config.comparePrice),b=l(K)+l(t.config.costPrice);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h6",{className:"text-sm font-medium text-blue-900 mb-3",children:"SKU 組成資訊"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"基礎 SKU: "}),e.jsx("span",{className:"font-mono text-blue-800 bg-white px-2 py-1 rounded",children:i||"N/A"})]}),y.length>0&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"層級路徑: "}),e.jsx("div",{className:"mt-1 space-y-1",children:y.map((c,C)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded mr-2",children:["L",C+1]}),e.jsxs("span",{className:"text-sm text-gray-800",children:[c.level,":"]}),e.jsx("span",{className:"font-medium text-gray-900 ml-1",children:c.option})]},C))})]}),e.jsxs("div",{className:"text-sm pt-2 border-t border-blue-200",children:[e.jsx("span",{className:"text-gray-600",children:"最終 SKU: "}),e.jsx("span",{className:"font-mono text-lg font-bold text-blue-800 bg-white px-2 py-1 rounded",children:t.fullSKU||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-sm font-medium text-gray-900 mb-3",children:"基本設定"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.config.isActive,onChange:c=>d("config.isActive",c.target.checked),className:"h-4 w-4 text-[#cc824d] border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"啟用此變體"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"條碼"}),e.jsx("input",{type:"text",value:t.config.barcode,onChange:c=>d("config.barcode",c.target.value),className:`${B.input} text-sm`,placeholder:"條碼"}),e.jsx(Le,{label:"預覽 QR",product:{name:A,categories:I,slug:i||t.fullSKU,price:P,comparePrice:E,costPrice:b},sku:{sku:t.fullSKU,salePrice:P,comparePrice:E,costPrice:b,variantPath:y.map(c=>({level:c.level,option:c.option})),images:Array.isArray(t.config.variantImages)?t.config.variantImages:[]}})]})]})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-sm font-medium text-gray-900 mb-3",children:"價格設定"}),e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:'提示：此處輸入的是"差額"，會與定價設定中的基礎價格相加（可為負數）。'}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"售價 *"}),e.jsx("input",{type:"number",value:t.config.price,onChange:c=>d("config.price",c.target.value),className:`${B.input} text-sm`,placeholder:"0",step:"0.01"}),e.jsxs("div",{className:"mt-1 text-xs text-gray-600",children:["最終售價：NT$",Number(P).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"原價"}),e.jsx("input",{type:"number",value:t.config.comparePrice,onChange:c=>d("config.comparePrice",c.target.value),className:`${B.input} text-sm`,placeholder:"0",step:"0.01"}),e.jsxs("div",{className:"mt-1 text-xs text-gray-600",children:["最終原價：NT$",Number(E).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"成本價"}),e.jsx("input",{type:"number",value:t.config.costPrice,onChange:c=>d("config.costPrice",c.target.value),className:`${B.input} text-sm`,placeholder:"0",step:"0.01"}),e.jsxs("div",{className:"mt-1 text-xs text-gray-600",children:["最終成本：NT$",Number(b).toLocaleString()]})]})]})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-sm font-medium text-gray-900 mb-3",children:"變體圖片"}),e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"此處設定「此變體」專屬圖片。若未設定，將回退使用商品圖片或無圖。"}),e.jsx(Ae,{images:Array.isArray(t.config.variantImages)?t.config.variantImages:[],onChange:c=>d("config.variantImages",c),maxImages:3})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-sm font-medium text-gray-900 mb-3",children:"庫存管理"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.config.trackQuantity,onChange:c=>d("config.trackQuantity",c.target.checked),className:"h-4 w-4 text-[#cc824d] border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"追蹤庫存"})]}),t.config.trackQuantity&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"庫存數量 *"}),e.jsx("input",{type:"number",value:t.config.quantity,onChange:c=>d("config.quantity",c.target.value),className:`${B.input} text-sm`,placeholder:"0",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"低庫存警告"}),e.jsx("input",{type:"number",value:t.config.lowStockThreshold,onChange:c=>d("config.lowStockThreshold",c.target.value),className:`${B.input} text-sm`,placeholder:"5",min:"0"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.config.allowBackorder,onChange:c=>d("config.allowBackorder",c.target.checked),className:"h-4 w-4 text-[#cc824d] border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"允許缺貨預訂"})]}),e.jsxs("div",{className:`flex items-center text-xs px-2 py-1 rounded-full ${T==="low"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:[T==="low"?e.jsx(ve,{className:"w-3 h-3 mr-1"}):e.jsx(le,{className:"w-3 h-3 mr-1"}),T==="low"?"庫存不足":"庫存充足"]})]})]})]})]})},Le=({label:t="預覽 QR",product:d,sku:i})=>{const[j,w]=h.useState(!1);return e.jsxs("div",{className:"mt-2",children:[e.jsxs("button",{type:"button",onClick:()=>w(!0),className:"inline-flex items-center px-2.5 py-1.5 text-xs border border-[#cc824d] text-[#cc824d] rounded hover:bg-[#cc824d] hover:text-white transition-colors",children:[e.jsx(ye,{className:"w-4 h-4 mr-1"})," ",t]}),e.jsx(he,{isOpen:j,onClose:()=>w(!1),title:`QR 預覽 - ${(i==null?void 0:i.sku)||""}`,product:d,sku:i,size:"max-w-2xl"})]})};export{Ae as I,Ve as N,$e as P};
