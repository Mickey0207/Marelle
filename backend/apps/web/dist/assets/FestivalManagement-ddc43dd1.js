import{r as l,j as e}from"./index-5be64975.js";import{I as k}from"./IconActionButton-2bcd0b2a.js";import{G as O}from"./GlassModal-8d9cbd14.js";import{S as Y}from"./StandardTable-046e436b.js";import{S as p}from"./SearchableSelect-06cd3eb3.js";import{P as Z}from"./PlusIcon-86b6a2f5.js";import{C as ee}from"./CalendarDaysIcon-5f332d7c.js";import{P as te}from"./PencilIcon-0921d86f.js";import{E as se}from"./EyeIcon-db27fda4.js";import{T as ae}from"./TrashIcon-c73d815d.js";import"./XMarkIcon-404a829f.js";import"./chevron-down-e41c1b61.js";let i=[{id:"FES-1",name:"雙11活動",type:"traditional",status:"planning",startDate:"2025-11-01",endDate:"2025-11-11",description:"雙11特賣",bannerImage:"",themeColor:"#ff6b6b",targetProducts:[],promotionSettings:{discountType:"percentage",discountValue:10,freeShipping:!1,giftThreshold:0,giftItems:[]}}];const le=[{value:"traditional",label:"傳統節慶"},{value:"western",label:"西洋節日"},{value:"custom",label:"自訂活動"}],re=[{value:"draft",label:"草稿"},{value:"planning",label:"規劃中"},{value:"active",label:"進行中"},{value:"ended",label:"已結束"}],ne=[{value:"apparel",label:"服飾"},{value:"accessories",label:"配件"},{value:"jewelry",label:"珠寶"}],u={getFestivalTypes(){return le},getStatusOptions(){return re},getProductCategories(){return ne},getAllFestivals(){return i.map(n=>({...n}))},createFestival(n){const c={id:`FES-${Date.now()}`,...n};return i.unshift(c),c},updateFestival(n,o){const c=i.findIndex(S=>S.id===n);return c===-1?null:(i[c]={...i[c],...o},i[c])},deleteFestival(n){return i=i.filter(o=>o.id!==n),!0}},je=()=>{const[n,o]=l.useState([]),[c,S]=l.useState([]),[x,oe]=l.useState(""),[g,V]=l.useState("all"),[h,A]=l.useState("all"),[b,f]=l.useState(!1),[$,y]=l.useState(!1),[R,j]=l.useState(!1),[d,v]=l.useState(null),[U,D]=l.useState(!0),[a,r]=l.useState({name:"",type:"traditional",startDate:"",endDate:"",status:"draft",description:"",bannerImage:"",themeColor:"#ff6b6b",targetProducts:[],promotionSettings:{discountType:"percentage",discountValue:0,freeShipping:!1,giftThreshold:0,giftItems:[]}}),C=u.getFestivalTypes(),w=u.getStatusOptions(),B=u.getProductCategories(),G=[{value:"percentage",label:"百分比折扣"},{value:"fixed",label:"固定金額"},{value:"buy-one-get-one",label:"買一送一"}],F=l.useCallback(()=>{try{const t=u.getAllFestivals();o(t),D(!1)}catch(t){console.error("載入節慶數據失敗:",t),D(!1)}},[]),I=l.useCallback(()=>{let t=[...n];x&&(t=t.filter(s=>s.name.toLowerCase().includes(x.toLowerCase())||s.description.toLowerCase().includes(x.toLowerCase()))),g!=="all"&&(t=t.filter(s=>s.status===g)),h!=="all"&&(t=t.filter(s=>s.type===h)),S(t)},[n,x,g,h]);l.useEffect(()=>{F()},[F]),l.useEffect(()=>{I()},[I]);const Q=()=>{try{const t=u.createFestival(a);o([...n,t]),f(!1),N()}catch(t){console.error("創建節慶失敗:",t)}},z=()=>{try{const t=u.updateFestival(d.id,a);o(n.map(s=>s.id===d.id?t:s)),y(!1),v(null),N()}catch(t){console.error("更新節慶失敗:",t)}},W=()=>{try{u.deleteFestival(d.id),o(n.filter(t=>t.id!==d.id)),j(!1),v(null)}catch(t){console.error("刪除節慶失敗:",t)}},N=()=>{r({name:"",type:"traditional",startDate:"",endDate:"",status:"draft",description:"",bannerImage:"",themeColor:"#ff6b6b",targetProducts:[],promotionSettings:{discountType:"percentage",discountValue:0,freeShipping:!1,giftThreshold:0,giftItems:[]}})},q=t=>{v(t),r({name:t.name,type:t.type,startDate:t.startDate,endDate:t.endDate,status:t.status,description:t.description,bannerImage:t.bannerImage||"",themeColor:t.themeColor||"#ff6b6b",targetProducts:t.targetProducts||[],promotionSettings:t.promotionSettings||{discountType:"percentage",discountValue:0,freeShipping:!1,giftThreshold:0,giftItems:[]}}),y(!0)},H=t=>{v(t),j(!0)},T=t=>new Date(t).toLocaleDateString("zh-TW",{year:"numeric",month:"short",day:"numeric"}),J=t=>{const s=C.find(m=>m.value===t);return s?s.label:t},K=t=>{const s=w.find(m=>m.value===t);return s?s.label:t},X=t=>{switch(t){case"active":return"bg-green-100 text-green-800";case"draft":return"bg-gray-100 text-gray-800";case"scheduled":return"bg-blue-100 text-blue-800";case"paused":return"bg-yellow-100 text-yellow-800";case"ended":case"inactive":case"completed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return U?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#cc824d]"})}):e.jsxs("div",{className:"min-h-screen bg-[#fdf8f2] p-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"節慶管理"}),e.jsx("p",{className:"text-gray-600",children:"管理所有節慶活動的詳細設定"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center px-4 py-2 bg-[#cc824d] text-white font-medium rounded-lg hover:bg-[#b8734a] transition-colors",children:[e.jsx(Z,{className:"h-5 w-5 mr-2"}),"新建節慶"]})})]}),e.jsx("div",{className:"bg-white/70 backdrop-blur-sm border border-white/50 rounded-xl p-6 mb-8 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(p,{className:"w-full",options:[{value:"all",label:"所有狀態"},...w],value:g,onChange:t=>V(t),placeholder:"選擇狀態"})}),e.jsx("div",{children:e.jsx(p,{className:"w-full",options:[{value:"all",label:"所有類型"},...C],value:h,onChange:t=>A(t),placeholder:"選擇類型"})})]})}),e.jsx(Y,{title:"節慶列表",data:c,columns:[{key:"name",label:"節慶資訊",sortable:!0,render:(t,s)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg flex-shrink-0 flex items-center justify-center",style:{backgroundColor:(s.themeColor||"#999")+"20"},children:e.jsx(ee,{className:"h-6 w-6",style:{color:s.themeColor||"#999"}})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:s.description})]})]})},{key:"type",label:"類型",sortable:!0,render:(t,s)=>e.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:J(s.type)})},{key:"status",label:"狀態",sortable:!0,render:(t,s)=>e.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-xs font-medium ${X(s.status)}`,children:K(s.status)})},{key:"startDate",label:"開始時間",sortable:!0,render:(t,s)=>e.jsx("span",{className:"text-sm text-gray-900",children:T(s.startDate)})},{key:"endDate",label:"結束時間",sortable:!0,render:(t,s)=>e.jsx("span",{className:"text-sm text-gray-900",children:T(s.endDate)})},{key:"metrics",label:"效果數據",sortable:!1,render:(t,s)=>{var m,L,P,E,M,_;return e.jsxs("div",{className:"space-y-1 text-sm text-gray-900",children:[e.jsxs("div",{children:["瀏覽: ",((L=(m=s.analytics)==null?void 0:m.views)==null?void 0:L.toLocaleString())||0]}),e.jsxs("div",{children:["參與: ",((E=(P=s.analytics)==null?void 0:P.participation)==null?void 0:E.toLocaleString())||0]}),e.jsxs("div",{children:["收益: NT$",((_=(M=s.analytics)==null?void 0:M.revenue)==null?void 0:_.toLocaleString())||0]})]})}},{key:"actions",label:"操作",sortable:!1,render:(t,s)=>e.jsxs("div",{className:"flex space-x-2 text-sm font-medium",children:[e.jsx(k,{Icon:te,label:"編輯",variant:"amber",onClick:()=>q(s)}),e.jsx(k,{Icon:se,label:"查看詳情",variant:"blue"}),e.jsx(k,{Icon:ae,label:"刪除",variant:"red",onClick:()=>H(s)})]})}],showExport:!0,exportFileName:"節慶列表",className:"bg-white/70 backdrop-blur-sm border border-white/50 rounded-xl shadow-sm"})]}),e.jsx(O,{isOpen:b||$,title:b?"新建節慶":"編輯節慶",onClose:()=>{f(!1),y(!1),N()},contentClass:"pt-0 px-6",footer:null,actions:[{label:"取消",variant:"secondary",onClick:()=>{f(!1),y(!1),N()}},{label:b?"創建":"更新",onClick:b?Q:z}],children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"節慶名稱"}),e.jsx("input",{type:"text",value:a.name,onChange:t=>r({...a,name:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-[#cc824d] focus:border-[#cc824d]",placeholder:"輸入節慶名稱"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"節慶類型"}),e.jsx(p,{className:"w-full",options:C,value:a.type,onChange:t=>r({...a,type:t}),placeholder:"選擇節慶類型"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"狀態"}),e.jsx(p,{className:"w-full",options:w,value:a.status,onChange:t=>r({...a,status:t}),placeholder:"選擇狀態"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"開始日期"}),e.jsx("input",{type:"date",value:a.startDate,onChange:t=>r({...a,startDate:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-[#cc824d] focus:border-[#cc824d]"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"結束日期"}),e.jsx("input",{type:"date",value:a.endDate,onChange:t=>r({...a,endDate:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-[#cc824d] focus:border-[#cc824d]"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"主題顏色"}),e.jsx("input",{type:"color",value:a.themeColor,onChange:t=>r({...a,themeColor:t.target.value}),className:"w-full h-10 border border-gray-300 rounded-md focus:ring-[#cc824d] focus:border-[#cc824d]"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"描述"}),e.jsx("textarea",{value:a.description,onChange:t=>r({...a,description:t.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-[#cc824d] focus:border-[#cc824d]",placeholder:"輸入節慶描述"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"橫幅圖片 URL"}),e.jsx("input",{type:"url",value:a.bannerImage,onChange:t=>r({...a,bannerImage:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-[#cc824d] focus:border-[#cc824d]",placeholder:"輸入圖片 URL"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"目標商品類別"}),e.jsx(p,{className:"w-full",options:B,multiple:!0,value:a.targetProducts,onChange:t=>r({...a,targetProducts:Array.isArray(t)?t:[]}),placeholder:"選擇商品類別",allowClear:!0})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"促銷設定"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"折扣類型"}),e.jsx(p,{className:"w-full",options:G,value:a.promotionSettings.discountType,onChange:t=>r({...a,promotionSettings:{...a.promotionSettings,discountType:t}}),placeholder:"選擇折扣類型"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"折扣值"}),e.jsx("input",{type:"number",value:a.promotionSettings.discountValue,onChange:t=>r({...a,promotionSettings:{...a.promotionSettings,discountValue:Number(t.target.value)}}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-[#cc824d] focus:border-[#cc824d]",placeholder:"輸入折扣值"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:a.promotionSettings.freeShipping,onChange:t=>r({...a,promotionSettings:{...a.promotionSettings,freeShipping:t.target.checked}}),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"免費運送"})]})})]})]})]})]})}),e.jsx(O,{isOpen:R,title:"確認刪除",onClose:()=>j(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-700",children:`確定要刪除節慶「${(d==null?void 0:d.name)??""}」嗎？此操作將同時刪除相關的促銷活動和優惠券，且無法復原。`}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>j(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"取消"}),e.jsx("button",{type:"button",onClick:W,className:"px-4 py-2 rounded-md text-white bg-red-600 hover:bg-red-700",children:"確認刪除"})]})]})})]})};export{je as default};
