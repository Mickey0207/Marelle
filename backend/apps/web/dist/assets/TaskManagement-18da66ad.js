import{r as n,j as e,c as K}from"./index-5be64975.js";import{d as O,m as v,T as x,a as j,b as Q,A as ee,B as L}from"./dashboardDataManager-4899f946.js";import{A as H}from"./ArrowPathIcon-3cac90dc.js";import{C as se}from"./CheckCircleIcon-3b5f52cb.js";import{E as te}from"./ExclamationTriangleIcon-5236f94b.js";import{C as ae}from"./ClockIcon-8dc756af.js";import{U as re}from"./UserIcon-c9b201ef.js";import{C as W}from"./ChevronDownIcon-47739443.js";import{F as le}from"./FunnelIcon-3b9657d7.js";import{X as B}from"./XCircleIcon-81e55d0c.js";function ne({title:s,titleId:i,...a},m){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":i},a),s?n.createElement("title",{id:i},s):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const ie=n.forwardRef(ne),de=ie;function ce({title:s,titleId:i,...a},m){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":i},a),s?n.createElement("title",{id:i},s):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))}const oe=n.forwardRef(ce),xe=oe,Te=()=>{const[s,i]=n.useState([]),[a,m]=n.useState([]),[d,c]=n.useState(!0),[o,r]=n.useState(null),[b,f]=n.useState(!1),[C,S]=n.useState(!1),[u,w]=n.useState(new Set),[h,k]=n.useState({status:[],priority:[],task_type:[],assigned_to:null,search:""}),[_,U]=n.useState("due_date"),[E,X]=n.useState("asc"),[A,R]=n.useState(1),[I]=n.useState(10),M=n.useCallback(async()=>{c(!0);try{const t=O.getTasks();i(t.tasks)}catch(t){console.error("Error loading tasks:",t)}finally{c(!1)}},[]);n.useEffect(()=>{M()},[M]);const $=n.useCallback(()=>{let t=[...s];h.search&&(t=t.filter(l=>l.title.toLowerCase().includes(h.search.toLowerCase())||l.description.toLowerCase().includes(h.search.toLowerCase()))),h.status.length>0&&(t=t.filter(l=>h.status.includes(l.status))),h.priority.length>0&&(t=t.filter(l=>h.priority.includes(l.priority))),h.task_type.length>0&&(t=t.filter(l=>h.task_type.includes(l.task_type))),h.assigned_to&&(t=t.filter(l=>l.assigned_to===h.assigned_to)),t.sort((l,p)=>{let g=l[_],y=p[_];return(_==="due_date"||_==="created_at")&&(g=g?new Date(g):new Date(0),y=y?new Date(y):new Date(0)),g<y?E==="asc"?-1:1:g>y?E==="asc"?1:-1:0}),m(t),R(1)},[s,h,_,E]);n.useEffect(()=>{$()},[$]);const T=async(t,l,p=null)=>{try{const g=O.updateTaskStatus(t,l,p);g&&i(y=>y.map(N=>N.id===t?g:N))}catch(g){console.error("Error updating task status:",g)}},Z=async(t,l,p=null,g=null,y=null)=>{try{const N=O.assignTask(t,l,p,g,y);N&&(i(J=>J.map(F=>F.id===t?N:F)),S(!1),r(null))}catch(N){console.error("Error assigning task:",N)}},z=async t=>{const l=Array.from(u);switch(t){case"complete":for(const p of l)await T(p,x.COMPLETED);break;case"cancel":for(const p of l)await T(p,x.CANCELLED);break}w(new Set)},Y=t=>{const l=new Set(u);l.has(t)?l.delete(t):l.add(t),w(l)},G=Math.ceil(a.length/I),V=(A-1)*I,q=V+I,D=a.slice(V,q);return d?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-amber-600"})}):e.jsxs("div",{children:[e.jsx(v.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"任務管理"}),e.jsx("p",{className:"text-gray-600",children:"管理和追蹤系統任務和工作項目"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("button",{onClick:M,className:"flex items-center px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"重新載入"]})})]})}),e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/70 backdrop-blur-md rounded-xl p-6 border border-white/20 shadow-lg mb-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsx(P,{label:"狀態",options:Object.values(x),selected:h.status,onChange:t=>k({...h,status:t}),getLabel:t=>t.replace("_"," ")}),e.jsx(P,{label:"優先級",options:Object.values(j),selected:h.priority,onChange:t=>k({...h,priority:t}),getLabel:t=>t}),e.jsx(P,{label:"任務類型",options:Object.values(Q),selected:h.task_type,onChange:t=>k({...h,task_type:t}),getLabel:t=>t.replace("_"," ")})]}),u.size>0&&e.jsxs(v.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("span",{className:"text-sm text-blue-800",children:["已選擇 ",u.size," 個任務"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>z("complete"),className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700",children:"標記完成"}),e.jsx("button",{onClick:()=>z("cancel"),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:"取消任務"}),e.jsx("button",{onClick:()=>w(new Set),className:"px-3 py-1 bg-gray-600 text-white text-sm rounded hover:bg-gray-700",children:"清除選擇"})]})]})]}),e.jsx(me,{tasks:a}),e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white/70 backdrop-blur-md rounded-xl border border-white/20 shadow-lg overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["任務列表 (",a.length,")"]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(ue,{sortBy:_,sortOrder:E,onSortChange:(t,l)=>{U(t),X(l)}})})]})}),e.jsx("div",{className:"hide-scrollbar",style:{overflowX:"scroll",scrollbarWidth:"none",msOverflowStyle:"none"},children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsx("input",{type:"checkbox",className:"rounded",checked:u.size===D.length&&D.length>0,onChange:t=>{t.target.checked?w(new Set(D.map(l=>l.id))):w(new Set)}})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"任務"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"狀態"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"優先級"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"指派者"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"到期日"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-white/30 divide-y divide-gray-200",children:e.jsx(ee,{children:D.map((t,l)=>e.jsx(he,{task:t,index:l,isSelected:u.has(t.id),onToggleSelect:()=>Y(t.id),onStatusChange:(p,g)=>T(t.id,p,g),onAssign:()=>{r(t),S(!0)},onViewDetails:()=>{r(t),f(!0)}},t.id))})})]})}),G>1&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50/50",children:e.jsx(ge,{currentPage:A,totalPages:G,onPageChange:R})})]}),e.jsx(be,{task:o,isOpen:b,onClose:()=>{f(!1),r(null)},onStatusChange:(t,l)=>{T(o.id,t,l),f(!1),r(null)}}),e.jsx(pe,{task:o,isOpen:C,onClose:()=>{S(!1),r(null)},onAssign:Z})]})},me=({tasks:s})=>{const i={total:s.length,pending:s.filter(a=>a.status===x.PENDING).length,inProgress:s.filter(a=>a.status===x.IN_PROGRESS).length,completed:s.filter(a=>a.status===x.COMPLETED).length,overdue:s.filter(a=>a.status!==x.COMPLETED&&a.due_date&&new Date(a.due_date)<new Date).length};return e.jsxs("div",{className:"grid grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white/70 backdrop-blur-md rounded-lg p-4 border border-white/20 shadow-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:i.total}),e.jsx("div",{className:"text-sm text-gray-600",children:"總任務"})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-md rounded-lg p-4 border border-white/20 shadow-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600",children:i.pending}),e.jsx("div",{className:"text-sm text-gray-600",children:"待處理"})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-md rounded-lg p-4 border border-white/20 shadow-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.inProgress}),e.jsx("div",{className:"text-sm text-gray-600",children:"進行中"})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-md rounded-lg p-4 border border-white/20 shadow-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.completed}),e.jsx("div",{className:"text-sm text-gray-600",children:"已完成"})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-md rounded-lg p-4 border border-white/20 shadow-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.overdue}),e.jsx("div",{className:"text-sm text-gray-600",children:"逾期"})]})]})},he=({task:s,index:i,isSelected:a,onToggleSelect:m,onStatusChange:d,onAssign:c,onViewDetails:o})=>{var f,C;const[r,b]=n.useState(!1);return e.jsxs(v.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:i*.05},className:`hover:bg-gray-50/50 ${a?"bg-blue-50/50":""}`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",className:"rounded",checked:a,onChange:m})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[s.status&&e.jsx("div",{className:"mt-1",children:s.status===x.COMPLETED?e.jsx(se,{className:"h-5 w-5 text-green-500"}):s.status===x.IN_PROGRESS?e.jsx(H,{className:"h-5 w-5 text-blue-500"}):s.due_date&&new Date(s.due_date)<new Date?e.jsx(te,{className:"h-5 w-5 text-red-500"}):e.jsx(ae,{className:"h-5 w-5 text-amber-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.title}),e.jsx("div",{className:"text-sm text-gray-500 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800",children:(f=s.task_type)==null?void 0:f.replace("_"," ")}),s.business_impact&&e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-md text-xs font-medium ${s.business_impact===L.CRITICAL?"bg-red-100 text-red-800":s.business_impact===L.HIGH?"bg-orange-100 text-orange-800":s.business_impact===L.MEDIUM?"bg-amber-100 text-amber-800":"bg-blue-100 text-blue-800"}`,children:s.business_impact})]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${s.status===x.COMPLETED?"bg-green-100 text-green-800":s.status===x.IN_PROGRESS?"bg-blue-100 text-blue-800":s.status===x.CANCELLED?"bg-gray-100 text-gray-800":s.due_date&&new Date(s.due_date)<new Date?"bg-red-100 text-red-800":"bg-amber-100 text-amber-800"}`,children:(C=s.status)==null?void 0:C.replace("_"," ")})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${s.priority===j.CRITICAL?"bg-red-100 text-red-800 border-red-200":s.priority===j.URGENT?"bg-orange-100 text-orange-800 border-orange-200":s.priority===j.HIGH?"bg-amber-100 text-amber-800 border-amber-200":s.priority===j.MEDIUM?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-800 border-gray-200"}`,children:s.priority})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.assigned_to?`用戶 ${s.assigned_to}`:"未指派"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:`text-sm ${s.due_date&&new Date(s.due_date)<new Date&&s.status!==x.COMPLETED?"text-red-600 font-medium":"text-gray-900"}`,children:s.due_date?new Date(s.due_date).toLocaleDateString("zh-TW"):"-"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>b(!r),className:"text-gray-400 hover:text-gray-600",children:e.jsx(xe,{className:"h-5 w-5"})}),r&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200",children:e.jsxs("div",{className:"py-1",children:[e.jsx("button",{onClick:()=>{o(),b(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"查看詳情"}),e.jsx("button",{onClick:()=>{c(),b(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"重新指派"}),s.status!==x.COMPLETED&&e.jsx("button",{onClick:()=>{d(x.COMPLETED),b(!1)},className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:"標記完成"}),s.status===x.PENDING&&e.jsx("button",{onClick:()=>{d(x.IN_PROGRESS),b(!1)},className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:"開始執行"})]})})]})})]})},P=({label:s,options:i,selected:a,onChange:m,getLabel:d})=>{const[c,o]=n.useState(!1),[r,b]=n.useState({top:0,left:0,width:0}),f=n.useRef(null),C=()=>{if(f.current){const u=f.current.getBoundingClientRect();b({top:u.bottom+2,left:u.left,width:u.width})}},S=()=>{c||C(),o(!c)};return e.jsxs("div",{ref:f,className:"relative",children:[e.jsxs("button",{onClick:S,className:"flex items-center justify-between w-full px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-amber-500",children:[e.jsx("span",{children:a.length>0?`${s} (${a.length})`:s}),e.jsx(W,{className:"h-4 w-4"})]}),c&&K.createPortal(e.jsx("div",{className:"glass-dropdown fixed z-[99999]",style:{top:`${r.top}px`,left:`${r.left}px`,width:`${r.width}px`,zIndex:99999},children:e.jsx("div",{className:"max-h-60 hide-scrollbar",style:{overflowY:"scroll",scrollbarWidth:"none",msOverflowStyle:"none"},children:i.map(u=>e.jsx("label",{className:"glass-dropdown-option cursor-pointer",children:e.jsxs("div",{className:"flex items-center w-full",children:[e.jsx("input",{type:"checkbox",checked:a.includes(u),onChange:w=>{w.target.checked?m([...a,u]):m(a.filter(h=>h!==u))},className:"rounded mr-3"}),e.jsx("span",{className:"text-sm",children:d?d(u):u})]})},u))})}),document.body)]})},ue=({sortBy:s,sortOrder:i,onSortChange:a})=>{const[m,d]=n.useState(!1),c=[{field:"due_date",label:"到期日"},{field:"created_at",label:"建立日期"},{field:"priority",label:"優先級"},{field:"status",label:"狀態"}];return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>d(!m),className:"flex items-center px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50",children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),"排序",e.jsx(W,{className:"h-4 w-4 ml-1"})]}),m&&e.jsx("div",{className:"absolute right-0 z-10 w-40 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg",children:e.jsx("div",{className:"p-1",children:c.map(o=>e.jsx("button",{onClick:()=>{s===o.field?a(o.field,i==="asc"?"desc":"asc"):a(o.field,"asc"),d(!1)},className:`w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 ${s===o.field?"bg-amber-50 text-amber-700":"text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:o.label}),s===o.field&&e.jsx("span",{className:"text-xs",children:i==="asc"?"↑":"↓"})]})},o.field))})})]})},ge=({currentPage:s,totalPages:i,onPageChange:a})=>{const m=[];let c=Math.max(1,s-Math.floor(2.5)),o=Math.min(i,c+5-1);o-c+1<5&&(c=Math.max(1,o-5+1));for(let r=c;r<=o;r++)m.push(r);return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["顯示第 ",(s-1)*10+1," - ",Math.min(s*10,i*10)," 項"]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>a(s-1),disabled:s===1,className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"上一頁"}),m.map(r=>e.jsx("button",{onClick:()=>a(r),className:`px-3 py-1 text-sm border rounded ${s===r?"bg-amber-600 text-white border-amber-600":"border-gray-300 hover:bg-gray-50"}`,children:r},r)),e.jsx("button",{onClick:()=>a(s+1),disabled:s===i,className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"下一頁"})]})]})},be=({task:s,isOpen:i,onClose:a,onStatusChange:m})=>{var d,c;return!i||!s?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs(v.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl p-6 max-w-2xl w-full mx-4 max-h-[80vh]",style:{overflowY:"scroll",scrollbarWidth:"none",msOverflowStyle:"none"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"任務詳情"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:e.jsx(B,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:s.title}),e.jsx("p",{className:"text-gray-600",children:s.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"狀態"}),e.jsx("p",{className:"mt-1",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${s.status===x.COMPLETED?"bg-green-100 text-green-800":s.status===x.IN_PROGRESS?"bg-blue-100 text-blue-800":"bg-amber-100 text-amber-800"}`,children:(d=s.status)==null?void 0:d.replace("_"," ")})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"優先級"}),e.jsx("p",{className:"mt-1",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${s.priority===j.CRITICAL?"bg-red-100 text-red-800":s.priority===j.HIGH?"bg-orange-100 text-orange-800":"bg-amber-100 text-amber-800"}`,children:s.priority})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"任務類型"}),e.jsx("p",{className:"mt-1 text-gray-900",children:(c=s.task_type)==null?void 0:c.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"業務影響"}),e.jsx("p",{className:"mt-1 text-gray-900",children:s.business_impact})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"建立日期"}),e.jsx("p",{className:"mt-1 text-gray-900",children:new Date(s.created_at).toLocaleDateString("zh-TW")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"到期日"}),e.jsx("p",{className:"mt-1 text-gray-900",children:s.due_date?new Date(s.due_date).toLocaleDateString("zh-TW"):"-"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"關閉"}),s.status!==x.COMPLETED&&e.jsx("button",{onClick:()=>m(x.COMPLETED),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"標記完成"})]})]})]})})},pe=({task:s,isOpen:i,onClose:a,onAssign:m})=>{const[d,c]=n.useState({assigned_to:"",priority:"",due_date:"",notes:""});if(n.useEffect(()=>{s&&c({assigned_to:s.assigned_to||"",priority:s.priority||"",due_date:s.due_date?new Date(s.due_date).toISOString().split("T")[0]:"",notes:""})},[s]),!i||!s)return null;const o=r=>{r.preventDefault(),m(s.id,parseInt(d.assigned_to),d.priority,d.due_date?new Date(d.due_date):null,d.notes||null)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs(v.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"指派任務"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:e.jsx(B,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"指派給"}),e.jsxs("select",{value:d.assigned_to,onChange:r=>c({...d,assigned_to:r.target.value}),className:"glass-select w-full font-chinese",required:!0,children:[e.jsx("option",{value:"",children:"選擇用戶"}),[...Array(10)].map((r,b)=>e.jsxs("option",{value:b+1,children:["用戶 ",b+1]},b+1))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"優先級"}),e.jsxs("select",{value:d.priority,onChange:r=>c({...d,priority:r.target.value}),className:"glass-select w-full font-chinese",children:[e.jsx("option",{value:"",children:"選擇優先級"}),Object.values(j).map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"到期日"}),e.jsx("input",{type:"date",value:d.due_date,onChange:r=>c({...d,due_date:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"備註"}),e.jsx("textarea",{value:d.notes,onChange:r=>c({...d,notes:r.target.value}),placeholder:"新增備註...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"取消"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700",children:"指派任務"})]})]})]})})};export{Te as default};
