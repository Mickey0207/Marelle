import{r as v,j as e,R as se}from"./index-5be64975.js";import{c as S,C as p}from"./chevron-down-e41c1b61.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ae=S("chevron-right",re);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],g=S("chevron-up",ne);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],le=S("download",ie),ce=({data:C=[],columns:u=[],title:R="數據列表",showExport:U=!0,onExport:$=null,exportFileName:E="數據列表",className:T="",emptyIcon:A=null,emptyTitle:q="沒有找到數據",emptyMessage:z="",emptyDescription:F="請調整搜尋條件或新增第一筆數據",enableBatchSelection:y=!1,selectedItems:h=[],onSelectedItemsChange:j=null,batchActions:O=[],getRowId:D=(o,k)=>o.id||k,enableRowExpansion:N=!1,getSubRows:_=null,subColumns:f=[],renderSubtableHeader:L=null,subtableClassName:G=""})=>{const[o,k]=v.useState({key:null,direction:"asc"}),[H,J]=v.useState(new Set),[V,K]=v.useState({}),M=(t,a)=>{if(!a||!a.key)return t;const{key:r,direction:n}=a;return[...t].sort((i,x)=>{const l=i[r],s=x[r];if(l==null)return 1;if(s==null)return-1;if(typeof l=="number"&&typeof s=="number")return n==="asc"?l-s:s-l;if(typeof l=="string"&&typeof s=="string"){const b=new Date(l),w=new Date(s);if(!isNaN(b)&&!isNaN(w))return n==="asc"?b-w:w-b}const c=String(l).toLowerCase(),d=String(s).toLowerCase();return c<d?n==="asc"?-1:1:c>d?n==="asc"?1:-1:0})},m=v.useMemo(()=>M(C,o),[C,o]),P=t=>{if(j)if(t){const a=m.map((r,n)=>D(r,n));j(a)}else j([])},Q=(t,a)=>{if(!j)return;const r=a?[...h,t]:h.filter(n=>n!==t);j(r)},W=y&&m.length>0&&h.length===m.length,X=y&&h.length>0&&h.length<m.length,Y=(t,a=!0)=>{if(!a)return;let r="asc";o.key===t&&o.direction==="asc"?r="desc":o.key===t&&o.direction==="desc"&&(r=null),k({key:r?t:null,direction:r})},Z=(t,a,r=!0)=>{r&&K(n=>{const i=n[t]||{key:null,direction:"asc"};let x="asc";return i.key===a&&i.direction==="asc"?x="desc":i.key===a&&i.direction==="desc"&&(x=null),{...n,[t]:{key:x?a:null,direction:x}}})},B=(t,a=!0)=>a?o.key!==t?e.jsxs("div",{className:"flex flex-col ml-1 opacity-30",children:[e.jsx(g,{className:"w-3 h-3 -mb-1"}),e.jsx(p,{className:"w-3 h-3"})]}):o.direction==="asc"?e.jsx(g,{className:"w-4 h-4 ml-1 text-apricot-600"}):o.direction==="desc"?e.jsx(p,{className:"w-4 h-4 ml-1 text-apricot-600"}):e.jsxs("div",{className:"flex flex-col ml-1 opacity-30",children:[e.jsx(g,{className:"w-3 h-3 -mb-1"}),e.jsx(p,{className:"w-3 h-3"})]}):null,I=(t,a,r=!0)=>{if(!r)return null;const n=V[t]||{key:null,direction:"asc"};return n.key!==a?e.jsxs("div",{className:"flex flex-col ml-1 opacity-30",children:[e.jsx(g,{className:"w-3 h-3 -mb-1"}),e.jsx(p,{className:"w-3 h-3"})]}):n.direction==="asc"?e.jsx(g,{className:"w-4 h-4 ml-1 text-apricot-600"}):n.direction==="desc"?e.jsx(p,{className:"w-4 h-4 ml-1 text-apricot-600"}):e.jsxs("div",{className:"flex flex-col ml-1 opacity-30",children:[e.jsx(g,{className:"w-3 h-3 -mb-1"}),e.jsx(p,{className:"w-3 h-3"})]})},ee=t=>{J(a=>{const r=new Set(a);return r.has(t)?r.delete(t):r.add(t),r})},te=()=>{if($){$(m);return}const t=u.map(l=>l.label||l.title||l.key).join(","),a=m.map(l=>u.map(s=>{const c=l[s.key];if(c==null)return"";const d=String(c);return d.includes(",")?`"${d}"`:d}).join(",")),r=[t,...a].join(`
`),n=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),x=URL.createObjectURL(n);i.setAttribute("href",x),i.setAttribute("download",`${E}.csv`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)};return e.jsx("div",{className:`glass rounded-2xl overflow-visible ${T}`,children:e.jsxs("div",{className:"overflow-x-auto overflow-y-visible",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 font-chinese",children:[R," (",m.length,")"]}),U&&e.jsxs("button",{onClick:te,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center gap-2 font-chinese",children:[e.jsx(le,{className:"w-4 h-4"}),"匯出"]})]})}),y&&h.length>0&&e.jsx("div",{className:"px-6 py-3 bg-blue-50 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-blue-700 font-chinese",children:["已選擇 ",h.length," 項"]}),e.jsx("div",{className:"flex items-center gap-2",children:O.map((t,a)=>e.jsxs("button",{onClick:()=>t.onClick(h),className:`px-3 py-1 text-sm rounded-md transition-colors font-chinese ${t.variant==="danger"?"bg-red-100 text-red-700 hover:bg-red-200":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:[t.icon&&e.jsx(t.icon,{className:"w-4 h-4 mr-1 inline"}),t.label]},a))})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[N&&e.jsx("th",{className:"px-3 py-3 text-left w-8"}),y&&e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:W,ref:t=>{t&&(t.indeterminate=X)},onChange:t=>P(t.target.checked),className:"rounded border-gray-300 text-apricot-600 focus:ring-apricot-500"})}),u.map((t,a)=>e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider font-chinese ${t.sortable!==!1?"cursor-pointer hover:bg-gray-100 select-none":""}`,onClick:()=>Y(t.key,t.sortable),children:e.jsxs("div",{className:"flex items-center",children:[t.label||t.title,B(t.key,t.sortable)]})},t.key||a))]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map((t,a)=>{const r=D(t,a),n=h.includes(r),i=N&&typeof _=="function"?_(t)||[]:[],x=N&&i.length>0,l=x&&H.has(r);return e.jsxs(se.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-gray-50",children:[N&&e.jsx("td",{className:"px-3 py-4 whitespace-nowrap align-top",children:x?e.jsx("button",{type:"button",onClick:()=>ee(r),className:"p-1 rounded hover:bg-gray-100 transition-colors","aria-label":l?"收合":"展開",children:l?e.jsx(p,{className:"w-4 h-4 text-gray-600"}):e.jsx(ae,{className:"w-4 h-4 text-gray-600"})}):null}),y&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",checked:n,onChange:s=>Q(r,s.target.checked),className:"rounded border-gray-300 text-apricot-600 focus:ring-apricot-500"})}),u.map((s,c)=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-chinese",children:s.render?s.render(t[s.key],t,a):e.jsx("span",{className:s.className||"text-gray-900",children:t[s.key]})},s.key||c))]}),l&&e.jsx("tr",{children:e.jsx("td",{className:"px-0 py-0 bg-gray-50",colSpan:u.length+(y?1:0)+(N?1:0),children:e.jsxs("div",{className:`p-4 border-t border-gray-200 ${G}`,children:[typeof L=="function"&&e.jsx("div",{className:"mb-3",children:L(t)}),i&&i.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden shadow-sm",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsx("tr",{children:f&&f.length>0?f.map((s,c)=>e.jsx("th",{className:`px-4 py-2 text-left text-xs font-medium text-gray-600 uppercase tracking-wider font-chinese ${s.sortable!==!1?"cursor-pointer hover:bg-gray-200 select-none":""}`,onClick:()=>Z(r,s.key,s.sortable),children:e.jsxs("div",{className:"flex items-center",children:[s.label||s.title,I(r,s.key,s.sortable)]})},s.key||c)):e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600 uppercase",children:"子表格"})})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:M(i,V[r]).map((s,c)=>e.jsx("tr",{className:"hover:bg-gray-50",children:f&&f.length>0?f.map((d,b)=>e.jsx("td",{className:"px-4 py-2 text-sm font-chinese",children:d.render?d.render(s[d.key],s,c,t):e.jsx("span",{className:d.className||"text-gray-900",children:s[d.key]})},d.key||b)):e.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:"未提供子表格欄位設定"})},s.id||c))})]})}):e.jsx("div",{className:"text-sm text-gray-500",children:"沒有可顯示的子項目"})]})})})]},r)})})]})}),m.length===0&&e.jsxs("div",{className:"text-center py-12",children:[A&&e.jsx(A,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2 font-chinese",children:z||q}),e.jsx("p",{className:"text-gray-500 font-chinese",children:F})]})]})})},xe=ce;export{xe as S};
