import{r as a,u as N,b as v,a as y,j as e,L as E}from"./index-5be64975.js";import{E as L}from"./EyeIcon-db27fda4.js";function S({title:n,titleId:o,...l},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":o},l),n?a.createElement("title",{id:o},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const k=a.forwardRef(S),I=k,R=()=>{const n=N(),{login:o}=v(),l=y(),[r,p]=a.useState({email:"",password:""}),[m,g]=a.useState(!1),[x,u]=a.useState(!1),[c,i]=a.useState(""),[b,d]=a.useState("");a.useEffect(()=>{const s=new URLSearchParams(l.search),t=s.get("line_status"),f=s.get("bound"),j=s.get("reason");t&&(t==="success"?d(f==="1"?"已綁定 LINE，後續可直接使用 LINE 登入":"尚未綁定任何帳號，請先以 Email/密碼登入後至「第三方登入」完成綁定"):t==="error"&&d(`LINE 登入失敗：${decodeURIComponent(j||"未知錯誤")}`))},[l.search]);const w=async s=>{s.preventDefault(),u(!0),i("");try{const t=await o(r);t.success?n("/"):i(t.message)}catch{i("登入失敗，請稍後再試")}finally{u(!1)}},h=(s,t)=>{p(f=>({...f,[s]:t})),c&&i("")};return e.jsx("div",{className:"min-h-screen flex flex-col bg-[#fdf8f2]",children:e.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center py-8 pt-16",children:[e.jsxs("form",{onSubmit:w,className:"w-full max-w-md mx-auto bg-transparent flex flex-col items-center",children:[e.jsx("h1",{className:"text-2xl font-serif font-bold text-[#2d1e0f] mb-8 mt-2 tracking-wider",children:"Marelle 管理員登入"}),e.jsxs("div",{className:"w-full flex flex-col gap-6",children:[e.jsxs("div",{children:[e.jsx("input",{type:"email",value:r.email,onChange:s=>h("email",s.target.value),className:"block w-full border-0 border-b border-[#e5ded6] bg-transparent text-base py-3 px-0 focus:ring-0 focus:border-[#bfae9b] placeholder-[#bfae9b] font-serif",placeholder:"管理員信箱",required:!0,autoFocus:!0}),e.jsx(E,{email:r.email})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:m?"text":"password",value:r.password,onChange:s=>h("password",s.target.value),className:"block w-full border-0 border-b border-[#e5ded6] bg-transparent text-base py-3 px-0 focus:ring-0 focus:border-[#bfae9b] placeholder-[#bfae9b] font-serif",placeholder:"密碼",required:!0}),e.jsx("button",{type:"button",onClick:()=>g(s=>!s),className:"absolute right-0 top-1/2 -translate-y-1/2 text-[#bfae9b] hover:text-[#a88c6b]",tabIndex:-1,children:m?e.jsx(I,{className:"w-5 h-5"}):e.jsx(L,{className:"w-5 h-5"})})]}),c&&e.jsx("div",{className:"text-red-600 text-sm font-serif text-center",children:c}),e.jsx("button",{type:"submit",disabled:x||!r.email||!r.password,className:"w-full bg-[#cc824d] hover:bg-[#b86c37] text-white text-base font-bold py-3 rounded transition-colors font-serif tracking-wider mt-2 disabled:bg-[#e5ded6] disabled:text-[#bfae9b]",children:x?"登入中...":"進入管理後台"})]}),e.jsxs("div",{className:"w-full flex items-center my-6",children:[e.jsx("div",{className:"flex-1 h-px bg-[#e5ded6]"}),e.jsx("span",{className:"mx-4 text-[#bfae9b] text-sm font-serif",children:"或使用社群帳號登入"}),e.jsx("div",{className:"flex-1 h-px bg-[#e5ded6]"})]})]}),e.jsxs("div",{className:"w-full max-w-md mx-auto mb-8",children:[b&&e.jsx("div",{className:"mb-3 text-sm text-[#2d1e0f] bg-[#fff2c2] border border-[#f1d48a] rounded p-3 font-serif text-center",children:b}),e.jsxs("button",{type:"button",onClick:()=>{const s=window&&window.__MARELLE_API_BASE__||"/",t=new URL("/backend/auth/line/start",s);t.searchParams.set("next",`${window.location.origin}/`),window.location.href=t.toString()},className:"w-full bg-[#00c300] hover:bg-[#00b300] text-white text-base font-bold py-3 rounded transition-colors font-serif tracking-wider flex items-center justify-center gap-3",children:[e.jsx("i",{className:"fa-brands fa-line text-xl"}),e.jsx("span",{children:"LINE 登入"})]})]})]})})};export{R as default};
