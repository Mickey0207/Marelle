import{j as t,r as c,A as o}from"./index-5be64975.js";import{G as D}from"./GlassModal-8d9cbd14.js";import{S as I}from"./SearchableSelect-06cd3eb3.js";import{T as se}from"./TabNavigation-b0ee78ba.js";import{V as ae,g as Pe,b as re,r as Me,a as Oe,c as Re}from"./presets-f50821a2.js";import"./XMarkIcon-404a829f.js";import"./chevron-down-e41c1b61.js";const De=({children:e,title:a="LINE",dark:r=!1})=>t.jsx("div",{className:"w-full flex justify-center",children:t.jsxs("div",{className:"w-full max-w-sm rounded-[36px] border border-gray-300 bg-white shadow-xl overflow-hidden",children:[t.jsx("div",{className:`px-4 py-2 text-sm ${r?"bg-black text-white":"bg-[#06c755] text-white"}`,children:a}),t.jsx("div",{className:"bg-gray-100 p-3 min-h-[480px] max-h-[640px] overflow-y-auto",children:e}),t.jsx("div",{className:"bg-white border-t border-gray-200 px-3 py-2 text-gray-400 text-sm",children:"訊息輸入列（預覽）"})]})});function Ie({node:e}){const a=e.maxLines&&e.wrap!==!1,r={color:e.color,textAlign:qe(e.align),fontWeight:e.weight,fontSize:G(e.size),lineHeight:e.lineSpacing,fontStyle:e.style==="italic"?"italic":void 0,textDecoration:e.decoration,whiteSpace:e.wrap?"pre-wrap":"nowrap",overflow:a?"hidden":void 0,display:a?"-webkit-box":void 0,WebkitLineClamp:a?e.maxLines:void 0,WebkitBoxOrient:a?"vertical":void 0,alignSelf:oe(e.gravity),marginTop:v(e.margin),flexGrow:z(e.flex),...S(e)},i=Array.isArray(e.contents)&&e.contents.length?t.jsx("div",{style:{...r,display:e.maxLines?"-webkit-box":void 0},children:e.contents.map((x,m)=>t.jsx(ce,{node:x},m))}):t.jsx("div",{style:r,children:e.text});return B(e,i)}function Ge({node:e}){const a=e.aspectRatio||"1:1",[r,i]=a.split(":").map(Number),x=i&&r?`${i/r*100}%`:void 0,m=e.aspectMode||"cover",l=J(e.cornerRadius);return B(e,t.jsx("div",{className:"w-full relative overflow-hidden",style:{paddingTop:x,borderRadius:l,marginTop:v(e.margin),backgroundColor:e.backgroundColor,...S(e)},children:t.jsx("img",{src:e.url,alt:"",className:"absolute inset-0 w-full h-full",style:{objectFit:m,borderRadius:l}})}))}function Je({node:e}){var l,f,y;const a=e.style==="primary",r=e.style==="secondary",i=a?"bg-[#06c755] text-white hover:opacity-90":r?"bg-gray-100 text-gray-900 hover:bg-gray-200":"text-[#06c755] hover:underline",x={backgroundColor:!a&&!r&&e.color?e.color:void 0,color:!a&&!r&&e.color?"white":void 0,marginTop:v(e.margin),alignSelf:oe(e.gravity),flexGrow:z(e.flex),...S(e)},m=t.jsx("button",{className:`w-full px-4 py-2 rounded-lg text-sm ${i}`,title:((l=e.action)==null?void 0:l.uri)||((f=e.action)==null?void 0:f.text),style:x,children:((y=e.action)==null?void 0:y.label)||"Button"});return B(e,m)}function ze({node:e}){return t.jsx("div",{className:"my-2",style:{borderTop:"1px solid",borderColor:(e==null?void 0:e.color)||"rgba(0,0,0,0.1)",marginTop:v(e==null?void 0:e.margin),...S(e||{})}})}function We({node:e}){const a=e.layout==="horizontal"||e.layout==="baseline"?"row":"column",r=e.layout==="baseline"?"baseline":Ue(e.align),i=Xe(e.justifyContent),x=Ye(e.spacing),m={position:"relative",display:"flex",flexDirection:a,alignItems:r,justifyContent:i,gap:x,background:ne(e)||void 0,backgroundColor:ne(e)?void 0:e.backgroundColor,borderRadius:J(e.cornerRadius),borderWidth:e.borderWidth?`${e.borderWidth}px`:void 0,borderStyle:e.borderWidth?"solid":void 0,borderColor:e.borderColor,...e.paddingAll!=null?{padding:h(e.paddingAll)}:{paddingTop:h(e.paddingTop),paddingBottom:h(e.paddingBottom),paddingLeft:h(e.paddingStart),paddingRight:h(e.paddingEnd)},marginTop:v(e.margin),flexGrow:z(e.flex),width:h(e.width)||void 0,height:h(e.height)||void 0,...S(e)},l=t.jsx("div",{style:m,children:Array.isArray(e.contents)&&e.contents.map((f,y)=>t.jsx(T,{node:f},y))});return B(e,l)}function _e({node:e}){const a=G(e.size)||"16px";return t.jsx("img",{src:e.url,alt:"",style:{width:a,height:a,marginTop:v(e.margin),...S(e)}})}function T({node:e}){if(!e)return null;switch(e.type){case"box":return t.jsx(We,{node:e});case"text":return t.jsx(Ie,{node:e});case"image":return t.jsx(Ge,{node:e});case"button":return t.jsx(Je,{node:e});case"separator":return t.jsx(ze,{node:e});case"icon":return t.jsx(_e,{node:e});case"spacer":return t.jsx(He,{node:e});case"filler":return t.jsx(Qe,{});case"span":return t.jsx(ce,{node:e});default:return null}}function le({json:e}){var l,f,y;const{header:a,hero:r,body:i,footer:x,styles:m}=e||{};return t.jsxs("div",{className:"w-full bg-white rounded-2xl shadow p-3 space-y-3",style:{borderRadius:J(e==null?void 0:e.cornerRadius),position:"relative"},children:[a&&t.jsx("div",{className:"px-1",style:{backgroundColor:(l=m==null?void 0:m.header)==null?void 0:l.backgroundColor,position:"relative"},children:t.jsx(T,{node:a})}),r&&t.jsx("div",{style:{position:"relative"},children:t.jsx(T,{node:r})}),i&&t.jsx("div",{className:"px-1",style:{backgroundColor:(f=m==null?void 0:m.body)==null?void 0:f.backgroundColor,position:"relative"},children:t.jsx(T,{node:i})}),x&&t.jsx("div",{className:"px-1",style:{backgroundColor:(y=m==null?void 0:m.footer)==null?void 0:y.backgroundColor,position:"relative"},children:t.jsx(T,{node:x})})]})}function Ve({json:e}){const a=Array.isArray(e==null?void 0:e.contents)?e.contents:[];return t.jsx("div",{className:"flex gap-3 overflow-x-auto py-1",children:a.map((r,i)=>t.jsx("div",{className:"min-w-[280px] max-w-[320px]",children:t.jsx(le,{json:r})},i))})}function Ke({data:e,title:a}){let r=null;return!e||typeof e!="object"?r=t.jsx("div",{className:"text-gray-500",children:"尚未提供或解析 Flex JSON"}):e.type==="bubble"?r=t.jsx(le,{json:e}):e.type==="carousel"?r=t.jsx(Ve,{json:e}):r=t.jsxs("div",{className:"text-red-600 text-sm",children:["不支援的 container type：",String(e.type)]}),t.jsx(De,{title:a,children:r})}function G(e){if(!e)return;const a={xs:"12px",sm:"14px",md:"16px",lg:"18px",xl:"20px",xxl:"24px","3xl":"28px"};return a[e]?a[e]:typeof e=="number"?`${e}px`:e}function Ye(e){const r={none:0,xs:4,sm:8,md:12,lg:16,xl:24,xxl:32}[e];return`${r??8}px`}function v(e){const r={none:0,xs:2,sm:4,md:8,lg:12,xl:16,xxl:24}[e];return r!=null?`${r}px`:void 0}function h(e){if(!(!e&&e!==0))return typeof e=="number"?`${e}px`:e}function J(e){if(!(!e&&e!==0))return typeof e=="number"?`${e}px`:e}function z(e){if(e!=null)return typeof e=="number"?e:e?1:0}function qe(e){if(e)return e==="start"?"left":e==="end"?"right":e}function Ue(e){switch(e){case"start":return"flex-start";case"end":return"flex-end";case"center":return"center";default:return}}function Xe(e){switch(e){case"start":return"flex-start";case"end":return"flex-end";case"center":return"center";case"space-between":return"space-between";case"space-around":return"space-around";case"space-evenly":return"space-evenly";default:return}}function S(e){if(!e||!e.position)return{};const a={position:e.position};return e.offsetTop!=null&&(a.top=h(e.offsetTop)),e.offsetBottom!=null&&(a.bottom=h(e.offsetBottom)),e.offsetStart!=null&&(a.left=h(e.offsetStart)),e.offsetEnd!=null&&(a.right=h(e.offsetEnd)),e.offsetX!=null&&(a.left=h(e.offsetX)),e.offsetY!=null&&(a.top=h(e.offsetY)),a}function He({node:e}){const r={xs:4,sm:8,md:12,lg:16,xl:24,xxl:32}[e==null?void 0:e.size]??8;return t.jsx("div",{style:{height:`${r}px`,width:"100%",marginTop:v(e==null?void 0:e.margin)}})}function Qe(){return t.jsx("div",{style:{flex:1}})}function ce({node:e}){const a={color:e.color,fontWeight:e.weight,fontStyle:e.style==="italic"?"italic":void 0,textDecoration:e.decoration,fontSize:G(e.size)};return t.jsx("span",{style:a,children:e.text})}function oe(e){switch(e){case"start":return"flex-start";case"end":return"flex-end";case"center":return"center";default:return}}function ne(e){const a=e==null?void 0:e.background;if(!a||a.type!=="linearGradient")return null;const r=a.angle||"0deg",i=[a.startColor,a.centerColor,a.endColor].filter(Boolean);return i.length?`linear-gradient(${r}, ${i.join(", ")})`:null}function B(e,a){const r=e==null?void 0:e.action;if(!r)return a;const i=r.uri||r.text||r.data||"action";return r.type==="uri"&&r.uri?t.jsx("a",{href:r.uri,target:"_blank",rel:"noreferrer",style:{cursor:"pointer",textDecoration:"none"},title:i,children:a}):t.jsx("div",{role:"button",style:{cursor:"pointer"},title:i,children:a})}const ue="__mock_line_flex_templates__";function N(){try{return JSON.parse(localStorage.getItem(ue)||"[]")}catch{return[]}}function A(e){localStorage.setItem(ue,JSON.stringify(e))}function ie(){return N()}function Ze(e){const a=String(e||"").toLowerCase();return N().filter(r=>(r.name||"").toLowerCase().includes(a)||(r.description||"").toLowerCase().includes(a)||(r.category||"").toLowerCase().includes(a)||(Array.isArray(r.tags)?r.tags.join(","):"").toLowerCase().includes(a))}function et(){return{type:"bubble",header:{type:"box",layout:"vertical",contents:[{type:"text",text:"Marelle",weight:"bold",size:"lg"}]},hero:{type:"image",url:"https://picsum.photos/800/400",size:"full",aspectRatio:"20:13",aspectMode:"cover"},body:{type:"box",layout:"vertical",spacing:"md",contents:[{type:"text",text:"精選商品",weight:"bold",size:"md"},{type:"text",text:"這是一個 Flex Message 預覽範例",size:"sm",color:"#666666",wrap:!0}]},footer:{type:"box",layout:"vertical",spacing:"sm",contents:[{type:"button",style:"primary",action:{type:"uri",label:"前往",uri:"https://example.com"}}]}}}function tt(e){const a=N(),r=JSON.stringify(et(),null,2),i={id:`LF-${Date.now()}`,name:"新 Flex 範本",description:"",category:"",tags:[],status:"draft",content:r,...e};return a.unshift(i),A(a),i}function st(e,a){const r=N().map(i=>i.id===e?{...i,...a,updatedAt:Date.now()}:i);A(r)}function at(e){const a=N().filter(r=>r.id!==e);A(a)}function rt(e){const a=N(),r=a.find(x=>x.id===e);if(!r)return null;const i={...r,id:`LF-${Date.now()}`,name:`${r.name||"未命名"} (複製)`,updatedAt:Date.now()};return a.unshift(i),A(a),i}function nt(e){const a=N().map(r=>r.id===e?{...r,status:"published",updatedAt:Date.now()}:r);A(a)}const mt=()=>{const[e,a]=c.useState(""),[r,i]=c.useState(null),[x,m]=c.useState([]),[l,f]=c.useState({name:"",category:"",description:"",tags:[],content:""}),[y,W]=c.useState(!1),_=c.useRef(null),[de,$]=c.useState(!1),[xe,F]=c.useState(!1),[me,P]=c.useState(!1),[V,K]=c.useState(!1),[M,Y]=c.useState(null),[pe,fe]=c.useState({recipient:""}),[q,ge]=c.useState(ae[0].key),[U,he]=c.useState(""),O=c.useMemo(()=>Pe(),[]),[E,X]=c.useState(()=>re());c.useMemo(()=>re(),[]);const[ye,H]=c.useState("default"),[C,be]=c.useState("preview");c.useEffect(()=>{const s=ie();m(s),s.length&&i(s[0].id)},[]);const d=c.useMemo(()=>x.find(s=>s.id===r)||null,[x,r]);c.useEffect(()=>{f(d?{name:d.name||"",category:d.category||"",description:d.description||"",tags:Array.isArray(d.tags)?d.tags:[],content:d.content||""}:{name:"",category:"",description:"",tags:[],content:""})},[d]);const Q=c.useMemo(()=>e?Ze(e):x,[e,x]),je=c.useMemo(()=>{const s=new Set;return x.forEach(n=>{n.category&&s.add(n.category)}),Array.from(s).map(n=>({label:n,value:n}))},[x]),ve=c.useMemo(()=>{const s=new Set;return x.forEach(n=>(n.tags||[]).forEach(p=>s.add(p))),Array.from(s).map(n=>({label:n,value:n}))},[x]),Z=c.useMemo(()=>{try{return Me(l.content||"",E||{})}catch{return l.content||""}},[l.content,E]),{parsed:Ne,jsonError:ee}=c.useMemo(()=>{try{return{parsed:JSON.parse(Z||"{}"),jsonError:null}}catch(s){return{parsed:null,jsonError:s.message}}},[Z]),we=c.useMemo(()=>Oe(),[]),te=s=>{const n=Re(s);n&&X(n)},Se=(s,n)=>n.split(".").reduce((p,u)=>p?p[u]:void 0,s),Ce=(s,n,p)=>{const u=n.split("."),j={...s||{}};let g=j;return u.forEach((b,w)=>{w===u.length-1?g[b]=p:(g[b]=typeof g[b]=="object"&&g[b]!==null?{...g[b]}:{},g=g[b])}),j},ke=s=>{const n=_.current;if(!n)return;const p=n.selectionStart??n.value.length,u=n.selectionEnd??p,j=n.value.slice(0,p),g=n.value.slice(u),b=j+s+g;f(w=>({...w,content:b})),requestAnimationFrame(()=>{n.focus();const w=p+s.length;n.setSelectionRange(w,w)})},k=()=>m(ie()),Te=()=>{const s=tt();k(),i(s.id)},Ae=s=>{s&&(rt(s),k())},$e=async()=>{if(d){W(!0);try{st(d.id,{name:l.name,category:l.category,description:l.description,tags:l.tags,content:l.content}),k()}finally{W(!1)}}},Ee=s=>{s&&(nt(s),k())},Le=()=>{d&&(at(d.id),k(),i(null),$(!1))},R=c.useMemo(()=>{const s=(l==null?void 0:l.content)||"",n=/\{\{\s*([\w.]+)\s*\}\}/g,p=new Set;let u;for(;u=n.exec(s);)u[1]&&p.add(u[1]);return Array.from(p)},[l==null?void 0:l.content]),L=c.useMemo(()=>{if(!R.length)return[];const s=O,n=[];Object.entries(s).forEach(([u,j])=>{(j||[]).forEach(g=>{const b=(g.token||"").replace(/\{\{|\}\}/g,"").trim();n.push({...g,category:u,path:b})})});const p=Object.fromEntries(n.map(u=>[u.path,u]));return R.map(u=>p[u]||{label:u,token:`{{${u}}}`,desc:"",category:u.split(".")[0],path:u})},[R,O]),Be=c.useMemo(()=>{const s=L.length;return C==="preview"?s<=2?"max-w-4xl":s<=8?"max-w-5xl":"max-w-6xl":s===0?"max-w-xl":s<=2?"max-w-2xl":s<=6?"max-w-3xl":s<=10?"max-w-4xl":"max-w-5xl"},[C,L.length]),Fe=()=>{K(!0),Y(null),setTimeout(()=>{K(!1),Y({success:!0,message:"測試 Flex 訊息已模擬送出"})},700)};return t.jsxs("div",{className:`${o.pageContainer}`,children:[t.jsxs("div",{className:`${o.contentContainer}`,children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:o.pageTitle,children:"Line Flex 訊息"}),t.jsx("p",{className:o.pageSubtitle,children:"建立、管理並預覽 LINE Flex Message。可貼上 Flex Simulator 匯出的 JSON 以預覽。"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{className:o.secondaryButton,onClick:()=>d&&Ae(d.id),children:"複製範本"}),t.jsx("button",{className:o.primaryButton,onClick:Te,children:"新增範本"})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-6 mt-6",children:[t.jsx("div",{className:"col-span-1",children:t.jsxs("div",{className:`${o.glassCard} space-y-4`,children:[t.jsx("div",{className:"flex gap-3",children:t.jsx("input",{placeholder:"搜尋名稱、描述、分類、標籤",value:e,onChange:s=>a(s.target.value),className:`${o.input}`})}),t.jsxs("div",{className:"divide-y divide-gray-200/60 border border-gray-200/60 rounded-xl overflow-hidden bg-white/70 backdrop-blur-sm",children:[Q.length===0&&t.jsx("div",{className:"p-4 text-gray-500",children:"沒有符合的範本"}),Q.map(s=>t.jsx("button",{onClick:()=>i(s.id),className:`w-full text-left p-4 transition-colors ${r===s.id?"bg-[#cc824d]/10":"hover:bg-gray-50/60"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900 font-chinese",children:s.name}),t.jsx("div",{className:"text-sm text-gray-500 line-clamp-1",children:s.description||"—"})]}),t.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${s.status==="published"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:s.status==="published"?"已發佈":"草稿"})]})},s.id))]})]})}),t.jsx("div",{className:"col-span-2",children:t.jsx("div",{className:`${o.glassCard} space-y-6`,children:d?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 font-chinese mb-1",children:"範本名稱"}),t.jsx("input",{className:o.input,value:l.name,onChange:s=>f(n=>({...n,name:s.target.value}))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 font-chinese mb-1",children:"分類"}),t.jsx(I,{options:je,value:l.category,onChange:s=>f(n=>({...n,category:s})),placeholder:"選擇分類"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 font-chinese mb-1",children:"描述"}),t.jsx("input",{className:o.input,value:l.description,onChange:s=>f(n=>({...n,description:s.target.value}))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 font-chinese mb-1",children:"標籤"}),t.jsx(I,{options:ve,value:l.tags,onChange:s=>f(n=>({...n,tags:s})),multiple:!0,placeholder:"新增或選擇標籤"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2 gap-3",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 font-chinese",children:"Flex JSON"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"text-xs text-gray-500",children:"可直接貼上 Flex Simulator 匯出的 JSON"}),t.jsx("button",{className:o.btnGhost,onClick:()=>P(!0),children:"插入變數"})]})]}),t.jsx("textarea",{ref:_,className:`${o.input} min-h-[420px] font-mono`,value:l.content,onChange:s=>f(n=>({...n,content:s.target.value})),placeholder:"貼上從 LINE Flex Simulator 匯出的 JSON"}),ee&&t.jsxs("div",{className:"mt-2 text-sm text-red-600",children:["JSON 解析錯誤：",ee]})]}),t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsxs("div",{className:"text-sm text-gray-500",children:["上次修改：",d.updatedAt?new Date(d.updatedAt).toLocaleString():"—"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{className:o.btnSecondary,onClick:()=>$(!0),children:"刪除"}),d.status!=="published"&&t.jsx("button",{className:o.btnGhost,onClick:()=>Ee(d.id),children:"發佈"}),t.jsx("button",{className:o.btnGhost,onClick:()=>F(!0),children:"預覽"}),t.jsx("button",{className:`${o.btnPrimary} ${y?"opacity-70 pointer-events-none":""}`,onClick:$e,children:y?"儲存中…":"儲存變更"})]})]})]}):t.jsx("div",{className:"text-gray-500",children:"請先在左側選擇或新增一個範本"})})})]})]}),t.jsx(D,{isOpen:de,onClose:()=>$(!1),title:"刪除範本",children:t.jsxs("div",{className:"space-y-4 p-6 pt-0",children:[t.jsxs("p",{className:"text-gray-600",children:["確定要刪除「",d==null?void 0:d.name,"」嗎？此動作無法復原。"]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{className:o.secondaryButton,onClick:()=>$(!1),children:"取消"}),t.jsx("button",{className:o.primaryButton,onClick:Le,children:"確定刪除"})]})]})}),t.jsx(D,{isOpen:xe,onClose:()=>F(!1),title:"預覽",size:Be,children:t.jsxs("div",{className:"space-y-6 p-6 pt-0",children:[t.jsx(se,{mode:"controlled",activeKey:C,onTabChange:s=>be(s.key||s.label),layout:"left",className:"px-2",tabs:[{key:"preview",label:"預覽與發送"},{key:"context",label:"情境與欄位"}]}),C==="preview"&&t.jsxs("div",{className:"grid grid-cols-12 gap-6 items-start",children:[t.jsx("div",{className:"col-span-6",children:t.jsx(Ke,{data:Ne,title:l.name||"Marelle"})}),t.jsxs("div",{className:"col-span-6",children:[t.jsx("div",{className:"text-sm text-gray-700 font-medium mb-3",children:"發送測試"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"測試接收者（名稱或 UserId）"}),t.jsx("input",{className:o.input,value:pe.recipient,onChange:s=>fe(n=>({...n,recipient:s.target.value})),placeholder:"例如：王小明 或 Uxxxxxxxx"})]}),t.jsx("div",{className:"text-xs text-gray-500",children:"不會真正送到 LINE，只做本地模擬"}),t.jsx("div",{className:"flex justify-end",children:t.jsx("button",{className:`${o.primaryButton} ${V?"opacity-70 pointer-events-none":""}`,onClick:Fe,children:V?"傳送中…":"送出測試"})}),M&&t.jsx("div",{className:`${M.success?"text-green-700 bg-green-50":"text-red-700 bg-red-50"} p-3 rounded-lg text-sm`,children:M.message})]})]})]}),C==="context"&&t.jsx("div",{className:"grid grid-cols-12 gap-6 items-start",children:t.jsxs("div",{className:"col-span-12",children:[t.jsx("div",{className:"text-sm text-gray-700 font-medium mb-3",children:"情境與欄位"}),t.jsxs("div",{className:"space-y-5",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"快速切換情境"}),t.jsx(I,{options:we,value:ye,onChange:s=>{H(s),te(s)},placeholder:"選擇情境"})]}),L.length===0?t.jsx("div",{className:"text-xs text-gray-500",children:"此範本未插入任何變數，無需調整欄位。"}):t.jsx("div",{className:"grid grid-cols-2 gap-4",children:L.map(s=>{const n=s.category==="system"||s.path.startsWith("system."),p=Se(E,s.path),u=`${s.label||s.path} ${s.path}`;return t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:u}),t.jsx("input",{className:o.input,value:p||"",disabled:n,onChange:j=>{const g=Ce(E,s.path,j.target.value);X(g)}})]},s.path)})}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"text-xs text-gray-500",children:"更改會即時反映於預覽分頁"}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("button",{className:o.secondaryButton,onClick:()=>{H("default"),te("default")},children:"重置"})})]})]})]})}),t.jsx("div",{className:"flex justify-end",children:t.jsx("button",{className:o.primaryButton,onClick:()=>F(!1),children:"關閉"})})]})}),t.jsx(D,{isOpen:me,onClose:()=>P(!1),title:"插入變數",children:t.jsxs("div",{className:"space-y-4 p-6 pt-0",children:[t.jsx(se,{mode:"controlled",activeKey:q,onTabChange:s=>ge(s.key),layout:"left",tabs:ae.map(s=>({key:s.key,label:s.label})),className:"px-2"}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("input",{value:U,onChange:s=>he(s.target.value),placeholder:"搜尋變數關鍵字…",className:`${o.input}`})}),t.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto px-1",children:(O[q]||[]).filter(s=>{const n=U.trim().toLowerCase();return n?[s.label,s.token,s.desc].filter(Boolean).some(p=>p.toLowerCase().includes(n)):!0}).map(s=>t.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl border border-gray-200/80 bg-white/80 hover:bg-gray-50/60 transition",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("div",{className:"font-medium text-gray-900 font-chinese",children:s.label}),t.jsx("div",{className:"text-xs text-gray-600 truncate font-mono",children:s.token}),s.desc&&t.jsx("div",{className:"text-xs text-gray-400",children:s.desc})]}),t.jsx("button",{className:o.primaryButton,onClick:()=>ke(s.token),children:"插入"})]},s.token))}),t.jsx("div",{className:"flex justify-end gap-2",children:t.jsx("button",{className:o.secondaryButton,onClick:()=>P(!1),children:"完成"})})]})})]})};export{mt as default};
