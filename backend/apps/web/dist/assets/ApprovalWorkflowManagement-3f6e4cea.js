import{r as l,j as e,R as F,c as G}from"./index-09c3368c.js";import{d as I,c,m as f,a as N,A as S}from"./dashboardDataManager-71a8028d.js";import{A}from"./ArrowPathIcon-fb014ed1.js";import{C as M}from"./ClipboardDocumentListIcon-6708fc27.js";import{C as W}from"./ChevronRightIcon-4b094a17.js";import{C as H}from"./ChevronDownIcon-05511def.js";import{X as P}from"./XCircleIcon-20cf1885.js";import{C as z}from"./ClockIcon-bab15198.js";import{C as V}from"./CheckCircleIcon-377c1a08.js";function J({title:s,titleId:r,...a},i){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":r},a),s?l.createElement("title",{id:r},s):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.498 15.25H4.372c-1.026 0-1.945-.694-2.054-1.715a12.137 12.137 0 0 1-.068-1.285c0-2.848.992-5.464 2.649-7.521C5.287 4.247 5.886 4 6.504 4h4.016a4.5 4.5 0 0 1 1.423.23l3.114 1.04a4.5 4.5 0 0 0 1.423.23h1.294M7.498 15.25c.618 0 .991.724.725 1.282A7.471 7.471 0 0 0 7.5 19.75 2.25 2.25 0 0 0 9.75 22a.75.75 0 0 0 .75-.75v-.633c0-.573.11-1.14.322-1.672.304-.76.93-1.33 1.653-1.715a9.04 9.04 0 0 0 2.86-2.4c.498-.634 1.226-1.08 2.032-1.08h.384m-10.253 1.5H9.7m8.075-9.75c.01.05.027.1.05.148.593 1.2.925 2.55.925 3.977 0 1.487-.36 2.89-.999 4.125m.023-8.25c-.076-.365.183-.75.575-.75h.908c.889 0 1.713.518 1.972 1.368.339 1.11.521 2.287.521 3.507 0 1.553-.295 3.036-.831 4.398-.306.774-1.086 1.227-1.918 1.227h-1.053c-.472 0-.745-.556-.5-.96a8.95 8.95 0 0 0 .303-.54"}))}const B=l.forwardRef(J),L=B;function U({title:s,titleId:r,...a},i){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":r},a),s?l.createElement("title",{id:r},s):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.633 10.25c.806 0 1.533-.446 2.031-1.08a9.041 9.041 0 0 1 2.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 0 0 .322-1.672V2.75a.75.75 0 0 1 .75-.75 2.25 2.25 0 0 1 2.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558.107 1.282.725 1.282m0 0h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 0 1-2.649 7.521c-.388.482-.987.729-1.605.729H13.48c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 0 0-1.423-.23H5.904m10.598-9.75H14.25M5.904 18.5c.083.205.173.405.27.602.197.4-.078.898-.523.898h-.908c-.889 0-1.713-.518-1.972-1.368a12 12 0 0 1-.521-3.507c0-1.553.295-3.036.831-4.398C3.387 9.953 4.167 9.5 5 9.5h1.053c.472 0 .745.556.5.96a8.958 8.958 0 0 0-1.302 4.665c0 1.194.232 2.333.654 3.375Z"}))}const q=l.forwardRef(U),O=q;function X({title:s,titleId:r,...a},i){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":r},a),s?l.createElement("title",{id:r},s):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"}))}const Y=l.forwardRef(X),Z=Y,xe=()=>{const[s,r]=l.useState([]),[a,i]=l.useState([]),[m,p]=l.useState([]),[x,b]=l.useState(!0),[n,u]=l.useState(null),[y,g]=l.useState(!1),[v,w]=l.useState("pending"),[h,_]=l.useState({workflow_type:"",status:[],priority:[],search:""}),C=l.useCallback(async()=>{b(!0);try{const t=I.getApprovalInstances(),o=I.approvalWorkflows;r(t.instances),i(o)}catch(t){console.error("Error loading approval data:",t)}finally{b(!1)}},[]);l.useEffect(()=>{C()},[C]);const k=l.useCallback(()=>{let t=[...s];if(v==="pending"?t=t.filter(o=>o.overall_status===c.PENDING||o.overall_status===c.IN_PROGRESS):v==="history"&&(t=t.filter(o=>o.overall_status===c.APPROVED||o.overall_status===c.REJECTED||o.overall_status===c.CANCELLED)),h.search&&(t=t.filter(o=>{var d;return((d=o.submission_notes)==null?void 0:d.toLowerCase().includes(h.search.toLowerCase()))||o.entity_type.toLowerCase().includes(h.search.toLowerCase())})),h.workflow_type){const o=a.filter(d=>d.entity_type===h.workflow_type).map(d=>d.id);t=t.filter(d=>o.includes(d.workflow_id))}h.status.length>0&&(t=t.filter(o=>h.status.includes(o.overall_status))),h.priority.length>0&&(t=t.filter(o=>h.priority.includes(o.priority))),t.sort((o,d)=>new Date(d.submitted_at)-new Date(o.submitted_at)),p(t)},[s,h,v,a]);l.useEffect(()=>{k()},[k]);const E=async(t,o="")=>{try{console.log("Approving instance:",t,o),r(d=>d.map(j=>j.id===t?{...j,overall_status:c.APPROVED,completed_at:new Date,approval_history:[...j.approval_history,{id:Date.now(),action:"approve",approver_name:"當前用戶",decision_date:new Date,comments:o||"核准通過"}]}:j))}catch(d){console.error("Error approving instance:",d)}},D=async(t,o="")=>{try{console.log("Rejecting instance:",t,o),r(d=>d.map(j=>j.id===t?{...j,overall_status:c.REJECTED,completed_at:new Date,approval_history:[...j.approval_history,{id:Date.now(),action:"reject",approver_name:"當前用戶",decision_date:new Date,comments:o||"駁回申請"}]}:j))}catch(d){console.error("Error rejecting instance:",d)}};return x?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-amber-600"})}):e.jsxs("div",{children:[e.jsx(f.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"簽核流程管理"}),e.jsx("p",{className:"text-gray-600",children:"管理和監控審批工作流程"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("button",{onClick:C,className:"flex items-center px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"重新載入"]})})]})}),e.jsx(K,{instances:s}),e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/70 backdrop-blur-md rounded-xl border border-white/20 shadow-lg mb-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:[{key:"pending",label:"待簽核",count:s.filter(t=>t.overall_status===c.PENDING||t.overall_status===c.IN_PROGRESS).length},{key:"all",label:"全部",count:s.length},{key:"history",label:"歷史記錄",count:s.filter(t=>t.overall_status===c.APPROVED||t.overall_status===c.REJECTED).length}].map(t=>e.jsxs("button",{onClick:()=>w(t.key),className:`py-4 border-b-2 font-medium text-sm ${v===t.key?"border-amber-500 text-amber-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[t.label," (",t.count,")"]},t.key))})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("select",{value:h.workflow_type,onChange:t=>_({...h,workflow_type:t.target.value}),className:"glass-select font-chinese",children:[e.jsx("option",{value:"",children:"所有類型"}),e.jsx("option",{value:"purchase_order",children:"採購單"}),e.jsx("option",{value:"refund_request",children:"退款申請"}),e.jsx("option",{value:"promotion",children:"促銷活動"})]}),e.jsx(R,{label:"狀態",options:Object.values(c),selected:h.status,onChange:t=>_({...h,status:t})}),e.jsx(R,{label:"優先級",options:Object.values(N),selected:h.priority,onChange:t=>_({...h,priority:t})})]})})]}),e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"space-y-4",children:[e.jsx(S,{children:m.map((t,o)=>e.jsx(Q,{instance:t,workflow:a.find(d=>d.id===t.workflow_id),index:o,onApprove:d=>E(t.id,d),onReject:d=>D(t.id,d),onViewDetails:()=>{u(t),g(!0)}},t.id))}),m.length===0&&e.jsxs("div",{className:"text-center py-12 bg-white/70 backdrop-blur-md rounded-xl border border-white/20 shadow-lg",children:[e.jsx(M,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"沒有找到簽核項目"}),e.jsx("p",{className:"text-gray-500",children:v==="pending"?"目前沒有待簽核的項目":"沒有符合篩選條件的項目"})]})]}),e.jsx(te,{instance:n,workflow:n?a.find(t=>t.id===n.workflow_id):null,isOpen:y,onClose:()=>{g(!1),u(null)},onApprove:t=>{E(n.id,t),g(!1),u(null)},onReject:t=>{D(n.id,t),g(!1),u(null)}})]})},K=({instances:s})=>{const r={total:s.length,pending:s.filter(a=>a.overall_status===c.PENDING).length,approved:s.filter(a=>a.overall_status===c.APPROVED).length,rejected:s.filter(a=>a.overall_status===c.REJECTED).length,overdue:s.filter(a=>a.overall_status===c.PENDING&&a.due_date&&new Date(a.due_date)<new Date).length};return e.jsxs("div",{className:"grid grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white/70 backdrop-blur-md rounded-lg p-4 border border-white/20 shadow-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:r.total}),e.jsx("div",{className:"text-sm text-gray-600",children:"總申請"})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-md rounded-lg p-4 border border-white/20 shadow-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600",children:r.pending}),e.jsx("div",{className:"text-sm text-gray-600",children:"待簽核"})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-md rounded-lg p-4 border border-white/20 shadow-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.approved}),e.jsx("div",{className:"text-sm text-gray-600",children:"已核准"})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-md rounded-lg p-4 border border-white/20 shadow-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:r.rejected}),e.jsx("div",{className:"text-sm text-gray-600",children:"已駁回"})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-md rounded-lg p-4 border border-white/20 shadow-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:r.overdue}),e.jsx("div",{className:"text-sm text-gray-600",children:"逾期"})]})]})},Q=({instance:s,workflow:r,index:a,onApprove:i,onReject:m,onViewDetails:p})=>{const[x,b]=l.useState(!1),n=s.due_date&&s.overall_status===c.PENDING&&new Date(s.due_date)<new Date;return e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:a*.05},className:`bg-white/70 backdrop-blur-md rounded-xl p-6 border shadow-lg ${n?"border-red-300 bg-red-50/30":"border-white/20"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[$(s.overall_status),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:(r==null?void 0:r.workflow_name)||"未知工作流程"}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${T(s.priority)}`,children:s.priority}),n&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-red-100 text-red-800 rounded-full",children:"逾期"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"實體類型"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.entity_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"申請者"}),e.jsxs("p",{className:"text-sm text-gray-900",children:["用戶 ",s.submitted_by]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"提交時間"}),e.jsx("p",{className:"text-sm text-gray-900",children:new Date(s.submitted_at).toLocaleDateString("zh-TW")})]})]}),s.submission_notes&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"申請說明"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:s.submission_notes})]}),e.jsx(ee,{instance:s,workflow:r}),s.approval_history.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"最近操作"}),e.jsx("div",{className:"space-y-2",children:s.approval_history.slice(-2).map((u,y)=>e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${u.action==="approve"?"bg-green-500":u.action==="reject"?"bg-red-500":"bg-blue-500"}`}),e.jsx("span",{className:"font-medium",children:u.approver_name}),e.jsx("span",{className:"mx-1",children:"·"}),e.jsx("span",{children:u.action==="approve"?"核准":u.action==="reject"?"駁回":"處理"}),e.jsx("span",{className:"mx-1",children:"·"}),e.jsx("span",{children:new Date(u.decision_date).toLocaleDateString("zh-TW")})]},y))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:p,className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50",children:"查看詳情"}),s.overall_status===c.PENDING&&e.jsx(e.Fragment,{children:e.jsx("button",{onClick:()=>b(!x),className:"px-3 py-1 text-sm bg-amber-600 text-white rounded hover:bg-amber-700",children:"簽核"})})]})]}),e.jsx(S,{children:x&&e.jsx(se,{onApprove:i,onReject:m,onCancel:()=>b(!1)})})]})},ee=({instance:s,workflow:r})=>!r||!r.approval_steps?null:e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"簽核進度"}),e.jsx("div",{className:"flex items-center space-x-2",children:r.approval_steps.map((a,i)=>{const m=i+1===s.current_step,p=i+1<s.current_step;return e.jsxs(F.Fragment,{children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full text-xs font-medium ${p?"bg-green-500 text-white":m?"bg-amber-500 text-white":"bg-gray-200 text-gray-600"}`,children:p?"✓":i+1}),e.jsx("div",{className:"flex-1 text-center",children:e.jsx("div",{className:`text-xs font-medium ${m?"text-amber-600":p?"text-green-600":"text-gray-400"}`,children:a.step_name})}),i<r.approval_steps.length-1&&e.jsx(W,{className:`h-4 w-4 ${p?"text-green-500":m?"text-amber-500":"text-gray-300"}`})]},i)})})]}),se=({onApprove:s,onReject:r,onCancel:a})=>{const[i,m]=l.useState(""),p=x=>{x==="approve"?s(i):x==="reject"&&r(i),m("")};return e.jsxs(f.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 p-4 bg-gray-50 rounded-lg border",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"簽核意見"}),e.jsx("textarea",{value:i,onChange:x=>m(x.target.value),placeholder:"請輸入簽核意見...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent mb-3"}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:a,className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50",children:"取消"}),e.jsxs("button",{onClick:()=>p("reject"),className:"flex items-center px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700",children:[e.jsx(L,{className:"h-4 w-4 mr-1"}),"駁回"]}),e.jsxs("button",{onClick:()=>p("approve"),className:"flex items-center px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"核准"]})]})]})},R=({label:s,options:r,selected:a,onChange:i})=>{const[m,p]=l.useState(!1),[x,b]=l.useState({top:0,left:0,width:0}),n=l.useRef(null),u=()=>{if(n.current){const g=n.current.getBoundingClientRect();b({top:g.bottom+2,left:g.left,width:g.width})}},y=()=>{m||u(),p(!m)};return e.jsxs("div",{ref:n,className:"relative",children:[e.jsxs("button",{onClick:y,className:"flex items-center justify-between w-full px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-amber-500",children:[e.jsx("span",{children:a.length>0?`${s} (${a.length})`:s}),e.jsx(H,{className:"h-4 w-4"})]}),m&&G.createPortal(e.jsx("div",{className:"glass-dropdown fixed z-[99999]",style:{top:`${x.top}px`,left:`${x.left}px`,width:`${x.width}px`,zIndex:99999},children:e.jsx("div",{className:"max-h-60 hide-scrollbar",style:{overflowY:"scroll",scrollbarWidth:"none",msOverflowStyle:"none"},children:r.map(g=>e.jsx("label",{className:"glass-dropdown-option cursor-pointer",children:e.jsxs("div",{className:"flex items-center w-full",children:[e.jsx("input",{type:"checkbox",checked:a.includes(g),onChange:v=>{v.target.checked?i([...a,g]):i(a.filter(w=>w!==g))},className:"rounded mr-3"}),e.jsx("span",{className:"text-sm",children:g})]})},g))})}),document.body)]})},te=({instance:s,workflow:r,isOpen:a,onClose:i,onApprove:m,onReject:p})=>{const[x,b]=l.useState("");return!a||!s?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs(f.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl p-6 max-w-4xl w-full mx-4 max-h-[80vh] hide-scrollbar",style:{overflowY:"scroll",scrollbarWidth:"none",msOverflowStyle:"none"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"簽核詳情"}),e.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600",children:e.jsx(P,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"基本資訊"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"工作流程"}),e.jsx("p",{className:"text-sm text-gray-900",children:r==null?void 0:r.workflow_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"實體類型"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.entity_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"實體ID"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.entity_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"申請者"}),e.jsxs("p",{className:"text-sm text-gray-900",children:["用戶 ",s.submitted_by]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"提交時間"}),e.jsx("p",{className:"text-sm text-gray-900",children:new Date(s.submitted_at).toLocaleString("zh-TW")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"狀態"}),e.jsxs("p",{className:"text-sm text-gray-900 flex items-center",children:[$(s.overall_status),e.jsx("span",{className:"ml-2",children:s.overall_status})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"優先級"}),e.jsx("p",{className:"text-sm text-gray-900",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${T(s.priority)}`,children:s.priority})})]})]})]}),s.submission_notes&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"申請說明"}),e.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded-lg",children:s.submission_notes})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"簽核歷史"}),e.jsx("div",{className:"space-y-4",children:s.approval_history.map((n,u)=>e.jsxs("div",{className:"border-l-4 border-gray-200 pl-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${n.action==="approve"?"bg-green-500":n.action==="reject"?"bg-red-500":"bg-blue-500"}`}),e.jsx("span",{className:"font-medium text-gray-900",children:n.approver_name}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",n.approver_role,")"]})]}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(n.decision_date).toLocaleString("zh-TW")})]}),e.jsxs("div",{className:"text-sm text-gray-700",children:["操作: ",e.jsx("span",{className:"font-medium",children:n.action==="approve"?"核准":n.action==="reject"?"駁回":n.action==="delegate"?"委派":n.action==="request_info"?"要求補充資訊":"其他"})]}),n.comments&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["意見: ",n.comments]})]},u))})]})]}),s.overall_status===c.PENDING&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"簽核操作"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"簽核意見"}),e.jsx("textarea",{value:x,onChange:n=>b(n.target.value),placeholder:"請輸入簽核意見...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:i,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"關閉"}),e.jsxs("button",{onClick:()=>p(x),className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"駁回"]}),e.jsxs("button",{onClick:()=>m(x),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"核准"]})]})]})]})]})})},$=s=>{switch(s){case c.APPROVED:return e.jsx(V,{className:"h-5 w-5 text-green-500"});case c.REJECTED:return e.jsx(P,{className:"h-5 w-5 text-red-500"});case c.IN_PROGRESS:return e.jsx(A,{className:"h-5 w-5 text-blue-500"});case c.CANCELLED:return e.jsx(Z,{className:"h-5 w-5 text-gray-500"});default:return e.jsx(z,{className:"h-5 w-5 text-amber-500"})}},T=s=>{switch(s){case N.CRITICAL:return"bg-red-100 text-red-800 border-red-200";case N.URGENT:return"bg-orange-100 text-orange-800 border-orange-200";case N.HIGH:return"bg-amber-100 text-amber-800 border-amber-200";case N.MEDIUM:return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};export{xe as default};
