import{u as ce,r as _,j as e,A as c}from"./index-5be64975.js";import{I as de,P as pe}from"./ImageUpload-68adf005.js";import{A as me,P as ue,C as he,S as xe,a as ge}from"./AlertBox-2a4097d0.js";import{N as be}from"./NestedSKUManager-d9e30a19.js";import{X as Q}from"./XMarkIcon-404a829f.js";import{P as W}from"./PlusIcon-86b6a2f5.js";import{C as fe}from"./CubeIcon-717b6b1f.js";import{C as ye}from"./ChevronRightIcon-bd983f70.js";import{C as je}from"./CheckCircleIcon-3b5f52cb.js";import{I as Ne}from"./InformationCircleIcon-0b71784e.js";import{T as U}from"./TagIcon-a7572c43.js";import"./ChevronDownIcon-47739443.js";import"./CheckIcon-8874d163.js";import"./ExclamationTriangleIcon-5236f94b.js";import"./PencilIcon-0921d86f.js";import"./Cog6ToothIcon-88b00cb1.js";import"./TrashIcon-c73d815d.js";const Le=()=>{var O;const $=ce(),[x,S]=_.useState(0),[t,X]=_.useState({name:"",slug:"",description:"",shortDescription:"",categories:[],tags:[],promotionLabel:"",promotionLabelBgColor:"#CC824D",promotionLabelTextColor:"#FFFFFF",productTagBgColor:"#CC824D",productTagTextColor:"#FFFFFF",autoHideWhenOOS:!1,enablePreorder:!1,preorderStartAt:"",preorderEndAt:"",preorderMaxQty:"",price:"",comparePrice:"",costPrice:"",profit:"",profitMargin:"",baseSKU:"",hasVariants:!1,skuVariants:[],images:[],status:"draft",visibility:"visible",featured:!1,metaTitle:"",metaDescription:"",sitemapIndexing:!0,customCanonicalUrl:"",openGraphTitle:"",openGraphDescription:"",openGraphImage:"",useMetaTitleForOG:!0,useMetaDescriptionForOG:!0,excludeFromSearch:!1,searchTitle:"",searchDescription:"",searchImage:"",useMetaTitleForSearch:!0,useMetaDescriptionForSearch:!0,useOpenGraphImageForSearch:!0}),[p,C]=_.useState({}),[w,P]=_.useState(""),[K,Y]=_.useState([]),[v,k]=_.useState({show:!1,message:"",type:"warning"}),b=[{id:"basic",title:"基本資訊",description:"設定產品名稱、描述和基礎 SKU",icon:Ne,isCompleted:!1},{id:"variants",title:"SKU 變體管理",description:"設定五層巢狀 SKU 變體和庫存",icon:U,isCompleted:!1},{id:"categories",title:"商品分類",description:"設定商品分類歸屬",icon:U,isCompleted:!1},{id:"media",title:"圖片媒體",description:"上傳產品圖片和媒體",icon:pe,isCompleted:!1},{id:"seo",title:"SEO 設定",description:"搜尋引擎優化設定",icon:U,isCompleted:!1}],l=(s,r)=>{X(i=>({...i,[s]:r})),p[s]&&C(i=>({...i,[s]:null}))},Z=(s,r)=>{l(s,r)},F=()=>{w.trim()&&(l("tags",[w.trim()]),P(""))},ee=s=>{l("tags",t.tags.filter(r=>r!==s))},te=s=>{S(s),C({})},se=s=>{setTimeout(()=>{const r=document.querySelector(`[name="${s}"], #${s}`);r&&(r.scrollIntoView({behavior:"smooth",block:"center"}),r.focus())},100)},T=s=>s?s.toLowerCase().trim().replace(/[\u4e00-\u9fff]/g,r=>`char-${r.charCodeAt(0)}`).replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"").substring(0,50):"",ae=s=>{const r=b[s],i={};switch(r.id){case"basic":t.name.trim()||(i.name="產品名稱為必填項目"),t.slug.trim()?/^[a-z0-9-]+$/.test(t.slug)||(i.slug="路由只能包含小寫英文、數字和連字符"):i.slug="產品路由為必填項目",t.description.trim()||(i.description="產品描述為必填項目"),t.baseSKU.trim()?/^[a-z0-9]+$/.test(t.baseSKU)||(i.baseSKU="基礎 SKU 只能包含小寫英文和數字"):i.baseSKU="基礎 SKU 為必填項目";break;case"pricing":t.hasVariants||(!t.price||parseFloat(t.price)<=0)&&(i.price="請輸入有效的銷售價格");break;case"variants":t.hasVariants&&t.skuVariants.length===0&&(i.skuVariants="請設定至少一個 SKU 變體");break}return C(i),Object.keys(i).length===0},re=()=>{ae(x)&&(K.includes(x)||Y(s=>[...s,x]),S(s=>Math.min(s+1,b.length-1)))},oe=()=>{S(s=>Math.max(s-1,0))},le=async()=>{var I,D,V,A,L,E,M,B,G,R,q,z;const s={};let r=-1,i=null;for(let d=0;d<b.length;d++){const f=b[d],u={};switch(f.id){case"basic":t.name.trim()||(u.name="產品名稱為必填項目",r===-1&&(r=d,i="name")),t.slug.trim()?/^[a-z0-9-]+$/.test(t.slug)||(u.slug="路由只能包含小寫英文、數字和連字符",r===-1&&(r=d,i="slug")):(u.slug="產品路由為必填項目",r===-1&&(r=d,i="slug")),t.description.trim()||(u.description="產品描述為必填項目",r===-1&&(r=d,i="description")),t.baseSKU.trim()?/^[a-z0-9]+$/.test(t.baseSKU)||(u.baseSKU="基礎 SKU 只能包含小寫英文和數字",r===-1&&(r=d,i="baseSKU")):(u.baseSKU="基礎 SKU 為必填項目",r===-1&&(r=d,i="baseSKU"));break;case"pricing":t.hasVariants||(!t.price||parseFloat(t.price)<=0)&&(u.price="請輸入有效的銷售價格",r===-1&&(r=d,i="price"));break;case"variants":t.hasVariants&&t.skuVariants.length===0&&(u.skuVariants="請設定至少一個 SKU 變體",r===-1&&(r=d,i="skuVariants"));break}Object.keys(u).length>0&&(s[f.id]=u)}if(Object.keys(s).length>0){C(s[b[r].id]||{}),S(r);const d=Object.values(s).reduce((f,u)=>f+Object.keys(u).length,0);k({show:!0,type:"warning",title:"請完成必填項目",message:e.jsxs("div",{children:[e.jsxs("p",{children:["發現 ",d," 個未完成的必填項目："]}),e.jsx("ul",{className:"mt-2 text-xs space-y-1",children:Object.entries(s).map(([f,u])=>{var a;const j=(a=b.find(n=>n.id===f))==null?void 0:a.title;return Object.values(u).map((n,y)=>e.jsxs("li",{className:"flex items-center",children:[e.jsx("span",{className:"w-1 h-1 bg-current rounded-full mr-2"}),j,": ",n]},`${f}-${y}`))}).flat()})]})}),se(i);return}try{k({show:!1});const d=(Array.isArray(t.categories)?t.categories:[]).filter(a=>a!=null&&a!=="").map(a=>a!==null&&typeof a=="object"?a.id??a.value??a:a).map(a=>typeof a=="string"&&/^\d+$/.test(a)?Number(a):a).filter(a=>typeof a=="number"&&Number.isFinite(a)),f=await fetch("/backend/products",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:t.name,slug:t.slug,short_description:t.shortDescription||null,description:t.description,tags:t.tags,promotion_label:t.promotionLabel||null,promotion_label_bg_color:t.promotionLabelBgColor||null,promotion_label_text_color:t.promotionLabelTextColor||null,product_tag_bg_color:t.productTagBgColor||null,product_tag_text_color:t.productTagTextColor||null,auto_hide_when_oos:!!t.autoHideWhenOOS,enable_preorder:!!t.enablePreorder,preorder_start_at:t.preorderStartAt?new Date(t.preorderStartAt).toISOString():null,preorder_end_at:t.preorderEndAt?new Date(t.preorderEndAt).toISOString():null,preorder_max_qty:t.preorderMaxQty===""?null:Number(t.preorderMaxQty),base_sku:t.baseSKU,has_variants:t.hasVariants,status:t.status,visibility:t.visibility,is_featured:t.featured,...d.length>0?{category_ids:d}:{},meta_title:t.metaTitle||null,meta_description:t.metaDescription||null,og_title:t.openGraphTitle||null,og_description:t.openGraphDescription||null,og_image_url:t.openGraphImage||null,search_title:t.searchTitle||null,search_description:t.searchDescription||null,search_image_url:t.searchImage||null,sitemap_indexing:t.sitemapIndexing,custom_canonical_url:t.customCanonicalUrl||null,exclude_from_search:t.excludeFromSearch,use_meta_title_for_og:!!t.useMetaTitleForOG,use_meta_description_for_og:!!t.useMetaDescriptionForOG,use_meta_title_for_search:!!t.useMetaTitleForSearch,use_meta_description_for_search:!!t.useMetaDescriptionForSearch,use_og_image_for_search:!!t.useOpenGraphImageForSearch})});if(!f.ok)throw new Error(`建立商品失敗: ${f.statusText}`);const j=(await f.json()).id;if(t.images&&t.images.length>0){const a=[],n=[];for(let m=0;m<t.images.length;m++){const g=t.images[m];g.file?a.push(g.file):g.url&&n.push(g.url)}const y=[...n];if(a.length>0)for(const m of a){const g=new FormData;g.append("file",m);const o=await fetch(`/backend/products/${j}/storage-upload`,{method:"POST",credentials:"include",body:g});if(o.ok){const{url:h}=await o.json();y.push(h)}}if(y.length>0){const m={};for(let o=0;o<10;o++)m[`photo_url_${o+1}`]=y[o]||null;const g=await fetch(`/backend/products/${j}/photos`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(m)});g.ok||console.error(`更新商品圖片失敗: ${g.statusText}`)}}if(t.hasVariants&&t.skuVariants.length>0){for(const a of t.skuVariants)if(a.isActive)try{const n={sku_key:a.sku||null,warehouse:"主倉",current_stock_qty:a.quantity?parseInt(a.quantity):0,safety_stock_qty:a.lowStockThreshold?parseInt(a.lowStockThreshold):10,low_stock_threshold:a.lowStockThreshold?parseInt(a.lowStockThreshold):5,track_inventory:a.trackQuantity!==!1,allow_backorder:a.allowBackorder===!0,allow_preorder:!1,barcode:((I=a.config)==null?void 0:I.barcode)||null,hs_code:((D=a.config)==null?void 0:D.hsCode)||null,origin:((V=a.config)==null?void 0:V.origin)||null,notes:((A=a.config)==null?void 0:A.note)||null,weight:(L=a.config)!=null&&L.weight?parseFloat(a.config.weight):null,length_cm:(M=(E=a.config)==null?void 0:E.dimensions)!=null&&M.length?parseFloat(a.config.dimensions.length):null,width_cm:(G=(B=a.config)==null?void 0:B.dimensions)!=null&&G.width?parseFloat(a.config.dimensions.width):null,height_cm:(q=(R=a.config)==null?void 0:R.dimensions)!=null&&q.height?parseFloat(a.config.dimensions.height):null};if(a.path&&Array.isArray(a.path))for(let o=0;o<5;o++){const h=a.path[o];h?(n[`sku_level_${o+1}`]=h.option||null,n[`sku_level_${o+1}_name`]=h.option||null,n[`spec_level_${o+1}_name`]=h.level||null):(n[`sku_level_${o+1}`]=null,n[`sku_level_${o+1}_name`]=null,n[`spec_level_${o+1}_name`]=null)}else for(let o=0;o<5;o++)n[`sku_level_${o+1}`]=null,n[`sku_level_${o+1}_name`]=null,n[`spec_level_${o+1}_name`]=null;const y=await fetch(`/backend/products/${j}/inventory`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});y.ok||console.error(`建立變體 ${a.sku} 的庫存記錄失敗: ${y.statusText}`);let m=null;try{y.ok&&(m=await y.json())}catch{}if(a.price&&a.price!==""||a.comparePrice&&a.comparePrice!==""||a.costPrice&&a.costPrice!==""){const o={sku_key:a.sku||null,sale_price:a.price?parseFloat(a.price):0,compare_at_price:a.comparePrice?parseFloat(a.comparePrice):null,cost_price:a.costPrice?parseFloat(a.costPrice):null},h=await fetch(`/backend/products/${j}/prices`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)});h.ok?console.log(`成功建立變體 ${a.sku} 的價格記錄`):console.error(`建立變體 ${a.sku} 的價格記錄失敗: ${h.statusText}`)}if(m&&m.id){const o=Array.isArray((z=a.config)==null?void 0:z.variantImages)?a.config.variantImages:[];if(o.length>0){const h=[];for(const N of o.slice(0,3))if(N!=null&&N.file){const J=new FormData;J.append("file",N.file);const H=await fetch(`/backend/products/${j}/variant-photos/${m.id}/upload`,{method:"POST",credentials:"include",body:J});if(H.ok){const{url:ne}=await H.json();h.push(ne)}}else N!=null&&N.url&&h.push(N.url);const ie={variant_photo_url_1:h[0]||null,variant_photo_url_2:h[1]||null,variant_photo_url_3:h[2]||null};await fetch(`/backend/products/${j}/variant-photos/${m.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(ie)}).catch(N=>console.warn("建立變體圖片失敗:",N))}}}catch(n){console.error(`處理變體 ${a.sku} 的庫存/價格記錄時出錯:`,n)}}else if(!t.hasVariants)try{const a={sku_key:null,warehouse:"主倉",current_stock_qty:0,safety_stock_qty:10,low_stock_threshold:5,track_inventory:!0,allow_backorder:!1,allow_preorder:!1},n=await fetch(`/backend/products/${j}/inventory`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)});if(n.ok?console.log("成功建立單一SKU產品的庫存記錄"):console.error(`建立單一SKU產品的庫存記錄失敗: ${n.statusText}`),t.price&&t.price!==""||t.comparePrice&&t.comparePrice!==""||t.costPrice&&t.costPrice!==""){const m={sku_key:null,sale_price:t.price?parseFloat(t.price):0,compare_at_price:t.comparePrice?parseFloat(t.comparePrice):null,cost_price:t.costPrice?parseFloat(t.costPrice):null},g=await fetch(`/backend/products/${j}/prices`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(m)});g.ok?console.log("成功建立單一SKU產品的價格記錄"):console.error(`建立單一SKU產品的價格記錄失敗: ${g.statusText}`)}}catch(a){console.error("建立單一SKU產品的庫存/價格記錄時出錯:",a)}k({show:!0,type:"success",title:"產品創建成功",message:`產品 "${t.name}" 已成功創建！`}),setTimeout(()=>{$("/products")},2e3)}catch(d){console.error("創建產品失敗:",d),k({show:!0,type:"error",title:"創建失敗",message:d.message||"創建產品時發生錯誤，請稍後再試。"})}};return e.jsx("div",{className:c.pageContainer,children:e.jsxs("div",{className:c.contentContainerFluid,children:[e.jsx(me,{show:v.show,onClose:()=>k({...v,show:!1}),title:v.title,message:v.message,type:v.type,autoClose:v.type==="success"?3e3:0}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{className:"w-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 font-chinese",children:"新增產品"}),e.jsx("p",{className:"text-gray-600 font-chinese mt-1",children:"創建新的產品並設定詳細資訊"}),e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"inline-flex items-center px-3 py-1 bg-[#cc824d]/10 text-[#cc824d] rounded-full text-sm font-medium",children:["步驟 ",x+1," / ",b.length,": ",(O=b[x])==null?void 0:O.title]})})]}),e.jsx("div",{className:"flex-1",children:e.jsx(ue,{steps:b,currentStep:x,onStepClick:te,completedSteps:K,compact:!0})})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-8",children:[x===0&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:c.sectionTitle,children:"基本資訊"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["產品名稱 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"name",id:"name",value:t.name,onChange:s=>{if(l("name",s.target.value),!t.slug||t.slug===T(t.name)){const r=T(s.target.value);l("slug",r)}},className:`${c.input} ${p.name?"border-red-500":""}`,placeholder:"輸入產品名稱"}),p.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["產品路由 (Slug) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",name:"slug",id:"slug",value:t.slug,onChange:s=>l("slug",s.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"-").replace(/-+/g,"-")),className:`${c.input} ${p.slug?"border-red-500":""}`,placeholder:"product-slug",pattern:"[a-z0-9-]+"}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("span",{className:"text-xs text-gray-400",children:"/products/"})})]}),e.jsx("button",{type:"button",onClick:()=>l("slug",T(t.name)),className:"px-3 py-2 text-xs bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 transition-colors",disabled:!t.name,children:"自動生成"})]}),p.slug&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.slug}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["產品網址將是: ",window.location.origin,"/products/",t.slug||"product-slug"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["基礎 SKU ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"baseSKU",id:"baseSKU",value:t.baseSKU,onChange:s=>{const r=s.target.value.toLowerCase().replace(/[^a-z0-9]/g,"");l("baseSKU",r)},className:`${c.input} ${p.baseSKU?"border-red-500":""}`,placeholder:"例如：iphone",maxLength:20}),p.baseSKU&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.baseSKU}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["基礎 SKU 將作為所有變體的前綴，例如：",t.baseSKU||"iphone","bkpro"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"簡短描述"}),e.jsx("input",{type:"text",value:t.shortDescription,onChange:s=>l("shortDescription",s.target.value),className:c.input,placeholder:"一句話描述產品特色"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["產品描述 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{name:"description",id:"description",value:t.description,onChange:s=>l("description",s.target.value),rows:4,className:`${c.input} ${p.description?"border-red-500":""}`,placeholder:"詳細描述產品功能、特色和使用方法"}),p.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"產品標籤"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:t.tags.map(s=>e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm",style:{background:t.productTagBgColor,color:t.productTagTextColor},children:[s,e.jsx("button",{type:"button",onClick:()=>ee(s),className:"ml-2",style:{color:t.productTagTextColor},children:e.jsx(Q,{className:"w-4 h-4"})})]},s))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:w,onChange:s=>P(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),F()),className:c.input,placeholder:"輸入標籤名稱"}),e.jsx("button",{type:"button",onClick:F,className:c.btnSecondary,children:e.jsx(W,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"產品標籤背景色"}),e.jsx("input",{type:"color",value:t.productTagBgColor,onChange:s=>l("productTagBgColor",s.target.value),className:"w-16 h-10 p-0 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"產品標籤字體色"}),e.jsx("input",{type:"color",value:t.productTagTextColor,onChange:s=>l("productTagTextColor",s.target.value),className:"w-16 h-10 p-0 border rounded"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"優惠標籤"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-end",children:[e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:t.promotionLabel,onChange:s=>l("promotionLabel",s.target.value),className:`flex-1 ${c.input}`,placeholder:"如：滿千折百 / 限時優惠"}),e.jsx("button",{type:"button",onClick:()=>l("promotionLabel",(t.promotionLabel||"").trim()),className:c.btnSecondary,title:"新增優惠標籤",children:e.jsx(W,{className:"w-4 h-4"})}),t.promotionLabel&&e.jsx("button",{type:"button",onClick:()=>l("promotionLabel",""),className:c.btnSecondary,title:"清除優惠標籤",children:e.jsx(Q,{className:"w-4 h-4"})})]})}),e.jsx("div",{className:"text-right",children:t.promotionLabel&&e.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-sm",style:{background:t.promotionLabelBgColor,color:t.promotionLabelTextColor},children:t.promotionLabel})})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"優惠標籤背景色"}),e.jsx("input",{type:"color",value:t.promotionLabelBgColor,onChange:s=>l("promotionLabelBgColor",s.target.value),className:"w-16 h-10 p-0 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"優惠標籤字體色"}),e.jsx("input",{type:"color",value:t.promotionLabelTextColor,onChange:s=>l("promotionLabelTextColor",s.target.value),className:"w-16 h-10 p-0 border rounded"})]})]})]}),e.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"缺貨與預購"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 text-[#cc824d] border-gray-300 rounded focus:ring-[#cc824d]",checked:t.autoHideWhenOOS,onChange:s=>l("autoHideWhenOOS",s.target.checked)}),e.jsx("span",{className:"text-sm text-gray-700",children:"缺貨自動下架"})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 text-[#cc824d] border-gray-300 rounded focus:ring-[#cc824d]",checked:t.enablePreorder,onChange:s=>l("enablePreorder",s.target.checked)}),e.jsx("span",{className:"text-sm text-gray-700",children:"啟用預購"})]}),t.enablePreorder&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"預購開始時間"}),e.jsx("input",{type:"datetime-local",value:t.preorderStartAt,onChange:s=>l("preorderStartAt",s.target.value),className:c.input})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"預購結束時間"}),e.jsx("input",{type:"datetime-local",value:t.preorderEndAt,onChange:s=>l("preorderEndAt",s.target.value),className:c.input})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"最大預購數"}),e.jsx("input",{type:"number",min:"0",value:t.preorderMaxQty,onChange:s=>l("preorderMaxQty",s.target.value),className:c.input,placeholder:"例如 100"})]})]})]})]})]})]})]}),x===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:c.sectionTitle,children:"SKU 變體管理"}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("input",{type:"checkbox",id:"hasVariants",checked:t.hasVariants,onChange:s=>l("hasVariants",s.target.checked),className:"h-4 w-4 text-[#cc824d] border-gray-300 rounded focus:ring-[#cc824d]"}),e.jsx("label",{htmlFor:"hasVariants",className:"ml-2 text-sm text-gray-700",children:"此產品有多個 SKU 變體 (如不同顏色、尺寸、規格等)"})]}),!t.hasVariants&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6 text-center",children:[e.jsx(fe,{className:"mx-auto h-12 w-12 text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-600 mb-2",children:"此商品為單一 SKU 商品"}),e.jsx("p",{className:"text-sm text-gray-500",children:"如果商品有不同的變體選項，請勾選上方的變體選項"}),t.baseSKU&&e.jsxs("div",{className:"mt-4 p-3 bg-white rounded border",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"商品 SKU:"}),e.jsx("p",{className:"font-mono text-lg text-[#cc824d]",children:t.baseSKU})]})]}),t.hasVariants&&e.jsx(be,{baseSKU:t.baseSKU,skuVariants:t.skuVariants,onChange:s=>l("skuVariants",s),productName:t.name,productCategories:t.categories}),p.skuVariants&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.skuVariants})]})]}),x===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:c.sectionTitle,children:"商品分類"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"選擇商品分類 (可複選)"}),e.jsx(he,{selectedCategories:t.categories,onChange:s=>l("categories",s)})]})]}),x===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:c.sectionTitle,children:"圖片媒體"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"產品圖片"}),e.jsx(de,{images:t.images,onChange:s=>l("images",s),maxImages:10})]})]}),x===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:c.sectionTitle,children:"SEO 設定"}),e.jsx(xe,{productData:t,onChange:Z,errors:p,categories:t.categories})]})]}),e.jsxs("div",{className:"border-t border-gray-200 px-8 py-6 flex items-center justify-between bg-gray-50 rounded-b-xl",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>$("/products"),className:c.btnSecondary,children:"取消"}),x>0&&e.jsxs("button",{type:"button",onClick:oe,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"上一步"]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["步驟 ",x+1," / ",b.length]}),e.jsx("div",{className:"flex space-x-3",children:x<b.length-1?e.jsxs("button",{type:"button",onClick:re,className:"inline-flex items-center px-6 py-2 bg-[#cc824d] text-white rounded-lg text-sm font-medium hover:bg-[#b86c37] transition-colors shadow-sm",children:["下一步",e.jsx(ye,{className:"w-4 h-4 ml-2"})]}):e.jsxs("button",{type:"button",onClick:le,className:"inline-flex items-center px-8 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition-colors shadow-sm",children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"創建產品"]})})]})]})]})]})})};export{Le as default};
