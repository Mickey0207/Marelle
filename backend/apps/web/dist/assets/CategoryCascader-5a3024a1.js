import{r as f,j as h}from"./index-5be64975.js";import{S as k}from"./SearchableSelect-06cd3eb3.js";const g=({tree:a=[],value:o=null,onChange:c,placeholder:x="選擇分類"})=>{const r=f.useCallback((e,t,l=[])=>{var s;for(const n of e){const u=[...l,n];if(n.id===t)return u;if((s=n.children)!=null&&s.length){const p=r(n.children,t,u);if(p)return p}}return null},[]),j=f.useMemo(()=>o?r(a,o):[],[a,o,r]),[i,d]=f.useState(j||[]);f.useEffect(()=>{const e=o?r(a,o):[];d(e||[])},[o,a,r]);const b=f.useMemo(()=>{const e=[];e.push(a.map(t=>({value:t.id,label:t.name,node:t})));for(let t=1;t<5;t++){const l=i[t-1],s=(l==null?void 0:l.children)||[];if(s.length)e.push(s.map(n=>({value:n.id,label:n.name,node:n})));else break}return e},[a,i]),y=(e,t)=>{var u,p;if(!t){const m=e===0?null:((u=i[e-1])==null?void 0:u.id)||null;d(S=>S.slice(0,e)),c&&c(m);return}const s=(p=(b[e]||[]).find(m=>m.value===t))==null?void 0:p.node;if(!s)return;const n=[...i.slice(0,e),s];d(n),c&&c(s.id)},P=()=>{d([]),c&&c(null)};return h.jsxs("div",{className:"flex items-center space-x-2",children:[b.map((e,t)=>{var l;return h.jsx(k,{options:[{value:"",label:t===0?"全部":"無"},...e.map(s=>({value:s.value,label:s.label}))],value:((l=i[t])==null?void 0:l.id)||"",onChange:s=>y(t,s),placeholder:t===0?x:"選擇子分類",className:"w-40"},t)}),h.jsx("button",{className:"px-2 py-1 text-xs text-gray-600 hover:bg-gray-100 rounded",onClick:P,children:"清除"})]})};export{g as C};
