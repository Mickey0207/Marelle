import{r as n,u as C,a as L,b as I,j as e,A as W,N as M,O as R}from"./index-09c3368c.js";import{T as S}from"./TabNavigation-8088ee11.js";import{n as T}from"./notificationDataManager-7a4ef445.js";import{B as y}from"./BellIcon-118e5e67.js";import{S as A}from"./ShoppingBagIcon-ad17cd6a.js";import{C as $}from"./CubeIcon-1f7f940f.js";import{C as O}from"./ClipboardDocumentListIcon-6708fc27.js";import{M as B}from"./MapPinIcon-daf3590c.js";import{C as b}from"./ChartBarIcon-50296ea8.js";import{U as H}from"./UsersIcon-56853008.js";import{S as D}from"./ShoppingCartIcon-5bfc06d5.js";import{D as _}from"./DocumentTextIcon-57b6349a.js";import{S as F}from"./ShieldCheckIcon-3c374375.js";import{C as G}from"./Cog6ToothIcon-f8515c56.js";function P(s){if(!s||typeof s!="string")return[];const t=s.toLowerCase();return t.startsWith("/dashboard")?[{id:"overview",label:"總覽",href:"/dashboard/overview"},{id:"analytics",label:"分析",href:"/dashboard/sales-analytics"},{id:"operations",label:"運營",href:"/dashboard/operations"}]:t.startsWith("/settings")?[{id:"system",label:"系統",href:"/settings"},{id:"general",label:"一般",href:"/settings/general"},{id:"security",label:"安全",href:"/settings/security"},{id:"payment",label:"金流",href:"/settings/payment"},{id:"shipping",label:"物流",href:"/settings/shipping"},{id:"notifications",label:"通知",href:"/settings/notifications"}]:t.startsWith("/marketing")?[{id:"coupons",label:"優惠券",href:"/marketing/coupons"},{id:"festivals",label:"節慶活動",href:"/marketing/festivals"},{id:"gifts",label:"贈品",href:"/marketing/gifts"}]:t.startsWith("/orders")?[{id:"list",label:"訂單清單",href:"/orders"},{id:"management",label:"訂單管理",href:"/orders/management"}]:t.startsWith("/products")?[{id:"list",label:"商品清單",href:"/products"},{id:"add",label:"新增商品",href:"/products/add"}]:t.startsWith("/inventory")?[{id:"overview",label:"庫存清單",href:"/inventory"},{id:"warehouses",label:"倉庫管理",href:"/inventory/warehouses"}]:t.startsWith("/logistics")?[{id:"tracking",label:"物流追蹤",href:"/logistics"}]:t.startsWith("/notifications")?[{id:"history",label:"歷史",href:"/notifications"},{id:"line-text",label:"LINE 文字",href:"/notifications/line-text"},{id:"line-flex",label:"LINE Flex",href:"/notifications/line-flex"},{id:"mail-text",label:"Email 文字",href:"/notifications/mail-text"},{id:"mail-html",label:"Email HTML",href:"/notifications/mail-html"},{id:"sms",label:"SMS",href:"/notifications/sms"},{id:"web",label:"站內通知",href:"/notifications/web"}]:t.startsWith("/procurement")?[{id:"overview",label:"採購總覽",href:"/procurement"},{id:"suppliers",label:"供應商",href:"/procurement/suppliers"}]:t.startsWith("/members")?[{id:"members",label:"會員管理",href:"/members"}]:t.startsWith("/admin")?[{id:"admin",label:"管理員管理",href:"/admin"}]:t.startsWith("/fromsigning")?[{id:"approvals",label:"表單審批",href:"/fromsigning"}]:t.startsWith("/notification-center")?[{id:"overview",label:"總覽",href:"/notification-center"},{id:"orders",label:"訂單通知",href:"/notification-center/orders"},{id:"ecpay-payments",label:"綠界付款",href:"/notification-center/ecpay/payments"},{id:"ecpay-subscriptions",label:"綠界定期",href:"/notification-center/ecpay/subscriptions"},{id:"ecpay-codes",label:"綠界取號",href:"/notification-center/ecpay/codes"},{id:"ecpay-cardless",label:"綠界分期",href:"/notification-center/ecpay/cardless-installments"}]:t.startsWith("/analytics")?[{id:"overview",label:"總覽",href:"/analytics"},{id:"sales",label:"銷售",href:"/analytics/sales"},{id:"customers",label:"顧客",href:"/analytics/customers"},{id:"products",label:"商品",href:"/analytics/products"},{id:"operations",label:"運營",href:"/analytics/operations"},{id:"ai",label:"AI 洞察",href:"/analytics/ai-insights"}]:t.startsWith("/user-tracking")?[{id:"events",label:"事件",href:"/user-tracking/events"},{id:"sessions",label:"工作階段",href:"/user-tracking/sessions"},{id:"segments",label:"分群",href:"/user-tracking/segments"},{id:"funnels",label:"漏斗",href:"/user-tracking/funnels"},{id:"retention",label:"留存",href:"/user-tracking/retention"}]:[]}function V({title:s,titleId:t,...d},c){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":t},d),s?n.createElement("title",{id:t},s):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))}const X=n.forwardRef(V),Y=X;function z({title:s,titleId:t,...d},c){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":t},d),s?n.createElement("title",{id:t},s):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const U=n.forwardRef(z),q=U,fe=()=>{const s=C(),t=L(),{user:d,logout:c}=I(),[a,u]=n.useState(!1),[x,g]=n.useState(0),v=n.useRef(null),r=n.useRef(null),j=2,w=200;n.useEffect(()=>{const i=o=>{if(o.clientX<=j){a||u(!0),r.current&&(clearTimeout(r.current),r.current=null);return}const m=v.current;if(!m)return;const l=m.getBoundingClientRect(),f=o.clientX>=l.left&&o.clientX<=l.right&&o.clientY>=l.top&&o.clientY<=l.bottom;!f&&a?r.current||(r.current=setTimeout(()=>{u(!1),r.current=null},w)):f&&r.current&&(clearTimeout(r.current),r.current=null)};return window.addEventListener("mousemove",i),()=>window.removeEventListener("mousemove",i)},[a]);const p=P(t.pathname);n.useEffect(()=>{var i,o;try{const l=(((o=(i=T).getNotifications)==null?void 0:o.call(i))||[]).filter(f=>f.status==="failed"||f.status==="pending").length;g(l)}catch{g(0)}},[]);const N=()=>{c(),s("/login")},k=[{name:"總覽",href:"/dashboard/overview",icon:q},{name:"商品管理",href:"/products",icon:A},{name:"庫存管理",href:"/inventory",icon:$},{name:"訂單管理",href:"/orders",icon:O},{name:"物流管理",href:"/logistics",icon:B},{name:"通知管理",href:"/notifications",icon:y},{name:"行銷管理",href:"/marketing",icon:b},{name:"會員管理",href:"/members",icon:H},{name:"採購管理",href:"/procurement",icon:D},{name:"表單審批",href:"/fromsigning",icon:_},{name:"管理員管理",href:"/admin",icon:F},{name:"用戶追蹤",href:"/user-tracking",icon:b},{name:"數據分析",href:"/analytics",icon:b},{name:"系統設定",href:"/settings",icon:G}],E=i=>i==="/dashboard/overview"?t.pathname==="/"||t.pathname==="/dashboard/overview":t.pathname.startsWith(i),h=a;return e.jsxs("div",{className:`${W.pageContainer} flex`,children:[a&&e.jsx("div",{className:"fixed inset-0 z-40 bg-white/20 backdrop-blur-sm pointer-events-none transition-opacity duration-300"}),e.jsx("div",{className:`fixed inset-y-0 left-0 z-50 transform transition-all duration-300 ease-in-out will-change-transform ${a?"w-64":"w-16"} ${a?"shadow-xl":"shadow-sm"}`,ref:v,onMouseEnter:()=>{r.current&&(clearTimeout(r.current),r.current=null)},onMouseLeave:()=>{r.current||(r.current=setTimeout(()=>{u(!1),r.current=null},w))},children:e.jsxs("div",{className:`flex flex-col h-full bg-[#fdf8f2] border-r border-gray-200 shadow-sm ${h?"":"pointer-events-none"}`,children:[e.jsx("div",{className:"flex items-center justify-between px-4 h-16 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[e.jsx("div",{className:"w-9 h-9 bg-[#cc824d] rounded-lg flex items-center justify-center shadow-sm flex-shrink-0",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"M"})}),e.jsx("span",{className:`font-bold text-xl text-[#2d1e0f] font-serif transition-opacity duration-300 whitespace-nowrap ${a?"opacity-100":"opacity-0 w-0 overflow-hidden"}`,children:"Marelle 管理後台"})]})}),e.jsx("nav",{className:"flex-1 px-3 py-6 space-y-1","aria-hidden":!h,children:k.map(i=>e.jsxs(M,{to:i.href,tabIndex:h?0:-1,"aria-disabled":!h,className:({isActive:o})=>`flex items-center px-3 py-3 text-sm font-medium rounded-lg transition-all duration-200 font-serif group ${o||E(i.href)?"bg-[#cc824d] text-white shadow-sm":"text-gray-700 hover:bg-gray-100 hover:text-[#cc824d]"}`,title:a?"":i.name,children:[e.jsx(i.icon,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:`ml-3 transition-opacity duration-300 whitespace-nowrap ${a?"opacity-100":"opacity-0 w-0 overflow-hidden"}`,children:i.name})]},i.name))})]})}),e.jsxs("div",{className:`flex-1 flex flex-col min-w-0 transition-all duration-300 ease-in-out ${a?"ml-64":"ml-16"}`,children:[e.jsx("header",{className:"bg-[#fdf8f2] border-b border-gray-200 sticky top-0 z-30 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between px-8 h-16",children:[e.jsx("div",{className:"flex items-center flex-1",children:p&&p.length>0&&e.jsx("div",{className:"flex-1",children:e.jsx(S,{tabs:p,layout:"left",className:"text-sm"})})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>s("/notification-center"),className:"p-2 rounded-lg text-[#2d1e0f] hover:bg-[#f7ede3] hover:text-[#cc824d] transition-colors duration-200 relative",title:"通知中心",children:[e.jsx(y,{className:"w-5 h-5"}),x>0&&e.jsx("span",{className:"absolute -top-0.5 -right-0.5 min-w-[18px] h-[18px] px-1 bg-red-600 text-white text-[10px] leading-[18px] rounded-full text-center",children:x})]}),e.jsxs("button",{onClick:N,className:"flex items-center space-x-2 px-3 py-2 rounded-lg text-[#2d1e0f] hover:bg-[#f7ede3] hover:text-[#cc824d] transition-colors duration-200 font-serif",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"登出"})]})]})]})}),e.jsx("main",{className:"flex-1 overflow-hidden bg-[#fdf8f2]",style:{overflowY:"scroll",scrollbarWidth:"none",msOverflowStyle:"none"},children:e.jsx("div",{className:"h-full",children:e.jsx(R,{})})})]})]})};export{fe as default};
