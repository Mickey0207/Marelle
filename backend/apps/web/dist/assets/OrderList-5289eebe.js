import{r as d,g as $,j as e,A as k}from"./index-09c3368c.js";import{S as _}from"./SearchableSelect-bf34f521.js";import{I as f}from"./IconActionButton-fd764fa6.js";import{F as L}from"./FunnelIcon-694d59fc.js";import{T as A}from"./TrashIcon-41cd83e4.js";import{A as F}from"./ArrowDownTrayIcon-2accbe6b.js";import{E as B}from"./EyeIcon-bb65ea7b.js";import{P as R}from"./PencilIcon-619ae986.js";import{P as W}from"./PrinterIcon-5d2547b7.js";import"./chevron-down-5d12351e.js";const m=Array.from({length:28}).map((i,a)=>{const r=`ORD-${1e3+a}`,o=["張小明","李小美","王先生","陳小姐","林大哥"][a%5],x=Math.floor(Math.random()*5)+1,p=Math.floor(Math.random()*5e3)+1e3,b=["pending","processing","shipped","delivered","cancelled"][a%5],l=new Date(Date.now()-a*864e5).toISOString().slice(0,10);return{id:r,customerName:o,customerEmail:`user${a+1}@example.com`,items:x,amount:p,status:b,date:l,itemCount:x,totalAmount:p,createdAt:l}}),y={async getAllOrders(){return await new Promise(i=>setTimeout(i,80)),[...m]},async getOrderStatistics(){await new Promise(r=>setTimeout(r,50));const i=m.length,a=m.reduce((r,o)=>(r[o.status]=(r[o.status]||0)+1,r),{pending:0,processing:0,shipped:0,delivered:0,cancelled:0});return{totalOrders:i,statusDistribution:a}},deleteOrder(i){const a=m.findIndex(r=>r.id===i);return a===-1?{success:!1,error:"Not found"}:(m.splice(a,1),{success:!0})}},Z=()=>{const[i,a]=d.useState([]),[r,o]=d.useState(!0),[x,p]=d.useState("all"),b=[{value:"all",label:"全部狀態"},{value:"pending",label:"待處理"},{value:"processing",label:"處理中"},{value:"shipped",label:"已發貨"},{value:"delivered",label:"已送達"},{value:"cancelled",label:"已取消"}],[l,h]=d.useState([]),[u,j]=d.useState(1),[N]=d.useState(10),[X,C]=d.useState({total:0,pending:0,processing:0,shipped:0,delivered:0,cancelled:0});d.useEffect(()=>{v(),w(),$.fromTo(".order-card",{opacity:0,y:20},{opacity:1,y:0,duration:.6,stagger:.1,ease:"power2.out"})},[]);const v=async()=>{o(!0);try{const t=await y.getAllOrders();a(Array.isArray(t)?t:[])}catch(t){console.error("Error loading orders:",t)}finally{o(!1)}},w=async()=>{try{const t=await y.getOrderStatistics(),s=(t==null?void 0:t.statusDistribution)||{};C({total:(t==null?void 0:t.totalOrders)||0,pending:s.pending||0,processing:s.processing||0,shipped:s.shipped||0,delivered:s.delivered||0,cancelled:s.cancelled||0})}catch(t){console.error("Error loading statistics:",t)}},I=t=>{if(window.confirm("確定要刪除這個訂單嗎？此操作無法復原。")){const s=y.deleteOrder(t);s.success?(v(),w()):alert("刪除失敗："+s.error)}},E=()=>{if(l.length===0){alert("請先選擇要刪除的訂單");return}window.confirm(`確定要刪除選中的 ${l.length} 個訂單嗎？`)&&(l.forEach(t=>{y.deleteOrder(t)}),h([]),v(),w())},P=t=>{h(s=>s.includes(t)?s.filter(n=>n!==t):[...s,t])},D=()=>{l.length===c.length?h([]):h(c.map(t=>t.id))},M=t=>{const n={pending:{label:"待處理",className:"bg-yellow-100 text-yellow-800"},processing:{label:"處理中",className:"bg-blue-100 text-blue-800"},shipped:{label:"已發貨",className:"bg-purple-100 text-purple-800"},delivered:{label:"已送達",className:"bg-green-100 text-green-800"},cancelled:{label:"已取消",className:"bg-red-100 text-red-800"}}[t]||{label:t,className:"bg-gray-100 text-gray-800"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${n.className}`,children:n.label})},c=i.filter(t=>x==="all"||t.status===x),S=u*N,O=S-N,T=c.slice(O,S),g=Math.ceil(c.length/N);return r?e.jsx("div",{className:"bg-[#fdf8f2] min-h-screen p-6",children:e.jsxs("div",{className:"flex justify-center items-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#cc824d]"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"載入訂單數據中..."})]})}):e.jsxs("div",{className:"bg-[#fdf8f2] min-h-screen p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 font-chinese",children:"訂單管理"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"管理所有訂單信息與狀態"})]}),e.jsx("div",{className:`${k.glassCard} p-6 mb-6`,children:e.jsxs("div",{className:"flex gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"w-5 h-5 text-gray-400"}),e.jsx(_,{options:b,value:x,onChange:p,placeholder:"選擇狀態",className:"w-36"})]})}),e.jsxs("div",{className:"flex gap-2",children:[l.length>0&&e.jsxs("button",{onClick:E,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"刪除選中 (",l.length,")"]}),e.jsxs("button",{className:"px-4 py-2 bg-[#cc824d] text-white rounded-lg hover:bg-[#b8743d] transition-colors flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4"}),"匯出"]})]})]})}),e.jsxs("div",{className:`${k.glassCard} overflow-hidden`,children:[e.jsxs("div",{className:"",style:{overflowX:"scroll",scrollbarWidth:"none",msOverflowStyle:"none"},children:[e.jsx("style",{children:`
            div::-webkit-scrollbar {
              display: none;
            }
          `}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50/80 border-b border-gray-200/60",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:l.length===c.length&&c.length>0,onChange:D,className:"rounded border-gray-300 text-[#cc824d] focus:ring-[#cc824d]"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"訂單編號"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"客戶信息"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"商品數量"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"總金額"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"狀態"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"下單時間"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200/60",children:T.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50/40 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:l.includes(t.id),onChange:()=>P(t.id),className:"rounded border-gray-300 text-[#cc824d] focus:ring-[#cc824d]"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.id})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.customerName}),t.customerEmail&&e.jsx("div",{className:"text-sm text-gray-500",children:t.customerEmail})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[t.itemCount??t.items??0," 項商品"]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:Number((t.totalAmount??t.amount)||0).toLocaleString()})}),e.jsx("td",{className:"px-6 py-4",children:M(t.status)}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900",children:t.createdAt||t.date||"-"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex justify-center space-x-1",children:[e.jsx(f,{Icon:B,label:"檢視詳情",variant:"blue"}),e.jsx(f,{Icon:R,label:"編輯",variant:"amber"}),e.jsx(f,{Icon:W,label:"列印",variant:"green"}),e.jsx(f,{Icon:A,label:"刪除",variant:"red",onClick:()=>I(t.id)})]})})]},t.id))})]})]}),g>1&&e.jsxs("div",{className:"flex items-center justify-between px-6 py-3 border-t border-gray-200/60",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-700",children:["顯示 ",O+1," 到 ",Math.min(S,c.length)," 項， 共 ",c.length," 項結果"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>j(t=>Math.max(t-1,1)),disabled:u===1,className:"px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-500 hover:text-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"上一頁"}),e.jsx("div",{className:"flex space-x-1",children:[...Array(g)].map((t,s)=>{const n=s+1;return e.jsx("button",{onClick:()=>j(n),className:`px-3 py-1 rounded-md text-sm font-medium ${u===n?"bg-[#cc824d] text-white":"text-gray-500 hover:text-gray-700"}`,children:n},n)})}),e.jsx("button",{onClick:()=>j(t=>Math.min(t+1,g)),disabled:u===g,className:"px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-500 hover:text-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"下一頁"})]})]})]}),c.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"text-gray-500 text-lg",children:"沒有找到符合條件的訂單"})})]})};export{Z as default};
